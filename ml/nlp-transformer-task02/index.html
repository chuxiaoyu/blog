<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <meta name="generator" content="mkdocs-1.4.3, mkdocs-terminal-4.4.0">
     
     
    <link rel="icon" type="image/png" sizes="192x192" href="../../img/android-chrome-192x192.png" />
<link rel="icon" type="image/png" sizes="512x512" href="../../img/android-chrome-512x512.png" />
<link rel="apple-touch-icon" sizes="180x180" href="../../img/apple-touch-icon.png" />
<link rel="shortcut icon" type="image/png" sizes="48x48" href="../../img/favicon.ico" />
<link rel="icon" type="image/png" sizes="16x16" href="../../img/favicon-16x16.png" />
<link rel="icon" type="image/png" sizes="32x32" href="../../img/favicon-32x32.png" />


    
 
<title>Task02 å­¦ä¹ Attentioinå’ŒTransformer - èµ· èº« ç¨ ç«‹ å‘ è’ åŸ ã€‚</title>


<link href="../../css/fontawesome/css/fontawesome.min.css" rel="stylesheet">
<link href="../../css/fontawesome/css/solid.min.css" rel="stylesheet">
<link href="../../css/normalize.css" rel="stylesheet">
<link href="../../css/terminal.css" rel="stylesheet">
<link href="../../css/theme.css" rel="stylesheet">
<link href="../../css/theme.tile_grid.css" rel="stylesheet">
<link href="../../css/theme.footer.css" rel="stylesheet">
<!-- default color palette -->
<link href="../../css/palettes/default.css" rel="stylesheet">

<!-- page layout -->
<style>
/* initially set page layout to a one column grid */
.terminal-mkdocs-main-grid {
    display: grid;
    grid-column-gap: 1.4em;
    grid-template-columns: auto;
    grid-template-rows: auto;
}

/*  
*   when side navigation is not hidden, use a two column grid.  
*   if the screen is too narrow, fall back to the initial one column grid layout.
*   in this case the main content will be placed under the navigation panel. 
*/
@media only screen and (min-width: 70em) {
    .terminal-mkdocs-main-grid {
        grid-template-columns: 4fr 9fr;
    }
}</style>

<!-- link underline override -->
<style>
#terminal-mkdocs-main-content a:not(.headerlink){
    text-decoration: none;
}
</style>

     
    
    

    
    <!-- search css support -->
<link href="../../css/search/bootstrap-modal.css" rel="stylesheet">
<!-- search scripts -->
<script>
    var base_url = "../..",
    shortcuts = "{}";
</script>
<script src="../../js/jquery/jquery-1.10.1.min.js" defer></script>
<script src="../../js/bootstrap/bootstrap.min.js" defer></script>
<script src="../../js/mkdocs/base.js" defer></script>
    
    
    
    
    <script src="../../js/extra.js"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
    
    <script src="../../search/main.js"></script>
    

    
</head>

<body class="terminal"><div class="container">
    <div class="terminal-nav">
        <header class="terminal-logo">
            <div id="mkdocs-terminal-site-name" class="logo terminal-prompt"><a href="/" class="no-style">èµ· èº« ç¨ ç«‹ å‘ è’ åŸ ã€‚</a></div>
        </header>
        
        <nav class="terminal-menu">
            
            <ul vocab="https://schema.org/" typeof="BreadcrumbList">
                
                
                <li property="itemListElement" typeof="ListItem">
                    <a href="../.." class="menu-item " property="item" typeof="WebPage">
                        <span property="name">Home</span>
                    </a>
                    <meta property="position" content="0">
                </li>
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                    
                    


<li property="itemListElement" typeof="ListItem">
    <a href="#" class="menu-item" data-toggle="modal" data-target="#mkdocs_search_modal" property="item" typeof="SearchAction">
        <i aria-hidden="true" class="fa fa-search"></i> <span property="name">Search</span>
    </a>
    <meta property="position" content="1">
</li>
                    
            </ul>
            
        </nav>
    </div>
</div>
        
    <div class="container">
        <div class="terminal-mkdocs-main-grid"><aside id="terminal-mkdocs-side-panel"><nav>
  
    <ul class="terminal-mkdocs-side-nav-items">
        
          



<li class="terminal-mkdocs-side-nav-li">
    
    
    
        
        
            <a class="

    terminal-mkdocs-side-nav-item" href="../..">Home</a>
        
    
    
    
  </li>
        
          



<li class="terminal-mkdocs-side-nav-li">
    
    
        
        
            
                
        

        
            
    
        
        
            
            
            <span class="
        
            
        
    

    terminal-mkdocs-side-nav-item terminal-mkdocs-side-nav-section-no-index">Deep Learning for Time Series Forecasting</span>
        
    
    
        
      
        
            <ul class="terminal-mkdocs-side-nav-li-ul">
        
            
            
                
                
            

             
                <li class="terminal-mkdocs-side-nav-li-ul-li">
    
        
        
            <a class="

    terminal-mkdocs-side-nav-item" href="../../time-series/01-time-series-types/">Taxonomy of Time Series Forecasting</a>
        
    
    </li>
            
            
    </ul>
        
    
  </li>
        
          



<li class="terminal-mkdocs-side-nav-li">
    
    
        
        
            
                
        

        
            
    
        
        
            
            
            <span class="
        
            
        
    

    terminal-mkdocs-side-nav-item terminal-mkdocs-side-nav-section-no-index">CS224nè‡ªç„¶è¯­è¨€å¤„ç†</span>
        
    
    
        
      
        
            <ul class="terminal-mkdocs-side-nav-li-ul">
        
            
            
                
                
            

             
                <li class="terminal-mkdocs-side-nav-li-ul-li">
    
        
        
            <a class="

    terminal-mkdocs-side-nav-item" href="../Lecture07/">Lecture07 æœºå™¨ç¿»è¯‘ã€seq2seqæ¨¡å‹ã€æ³¨æ„åŠ›æœºåˆ¶</a>
        
    
    </li>
            
        
            
            
                
                
            

             
                <li class="terminal-mkdocs-side-nav-li-ul-li">
    
        
        
            <a class="

    terminal-mkdocs-side-nav-item" href="../Lecture09/">Lecture09 è‡ªæ³¨æ„åŠ›æ¨¡å‹ã€Transformers</a>
        
    
    </li>
            
        
            
            
                
                
            

             
                <li class="terminal-mkdocs-side-nav-li-ul-li">
    
        
        
            <a class="

    terminal-mkdocs-side-nav-item" href="../Lecture10/">Lecture10 é¢„è®­ç»ƒ</a>
        
    
    </li>
            
        
            
            
                
                
            

             
                <li class="terminal-mkdocs-side-nav-li-ul-li">
    
        
        
            <a class="

    terminal-mkdocs-side-nav-item" href="../Lecture11/">Lecture11 é—®ç­”ç³»ç»Ÿ</a>
        
    
    </li>
            
            
    </ul>
        
    
  </li>
        
          



<li class="terminal-mkdocs-side-nav-li">
    
    
        
        
            
                
        

        
            
    
        
        <span class="
        
            
        
    

    terminal-mkdocs-side-nav-item--active terminal-mkdocs-side-nav-section-no-index">åŸºäºtransformersçš„NLP</span>
    
    
        
      
        
            <ul class="terminal-mkdocs-side-nav-li-ul">
        
            
            
                
                
            

             
                <li class="terminal-mkdocs-side-nav-li-ul-li">
    
        
        
            <a class="

    terminal-mkdocs-side-nav-item" href="../nlp-transformer-task01/">Task01 NLPå­¦ä¹ æ¦‚è§ˆ</a>
        
    
    </li>
            
        
            
            
                
                
            

             
                <li class="terminal-mkdocs-side-nav-li-ul-li">
    
        
        <span class="

    terminal-mkdocs-side-nav-item--active">Task02 å­¦ä¹ Attentioinå’ŒTransformer</span>
    
    </li>
            
        
            
            
                
                
            

             
                <li class="terminal-mkdocs-side-nav-li-ul-li">
    
        
        
            <a class="

    terminal-mkdocs-side-nav-item" href="../nlp-transformer-task03/">Task03 å­¦ä¹ BERT</a>
        
    
    </li>
            
        
            
            
                
                
            

             
                <li class="terminal-mkdocs-side-nav-li-ul-li">
    
        
        
            <a class="

    terminal-mkdocs-side-nav-item" href="../nlp-transformer-task04/">Task04 å­¦ä¹ GPT</a>
        
    
    </li>
            
        
            
            
                
                
            

             
                <li class="terminal-mkdocs-side-nav-li-ul-li">
    
        
        
            <a class="

    terminal-mkdocs-side-nav-item" href="../nlp-transformer-task05/">Task05 ç¼–å†™BERTæ¨¡å‹</a>
        
    
    </li>
            
        
            
            
                
                
            

             
                <li class="terminal-mkdocs-side-nav-li-ul-li">
    
        
        
            <a class="

    terminal-mkdocs-side-nav-item" href="../nlp-transformer-task06/">Task06 BERTåº”ç”¨ã€è®­ç»ƒå’Œä¼˜åŒ–</a>
        
    
    </li>
            
        
            
            
                
                
            

             
                <li class="terminal-mkdocs-side-nav-li-ul-li">
    
        
        
            <a class="

    terminal-mkdocs-side-nav-item" href="../nlp-transformer-task07/">Task07 ä½¿ç”¨Transformersè§£å†³æ–‡æœ¬åˆ†ç±»ä»»åŠ¡</a>
        
    
    </li>
            
            
    </ul>
        
    
  </li>
        
          



<li class="terminal-mkdocs-side-nav-li">
    
    
        
        
            
                
        

        
            
    
        
        
            
            
            <span class="
        
            
        
    

    terminal-mkdocs-side-nav-item terminal-mkdocs-side-nav-section-no-index">æ·±å…¥æµ…å‡ºPyTorch</span>
        
    
    
        
      
        
            <ul class="terminal-mkdocs-side-nav-li-ul">
        
            
            
                
                
            

             
                <li class="terminal-mkdocs-side-nav-li-ul-li">
    
        
        
            <a class="

    terminal-mkdocs-side-nav-item" href="../pytorch-chap01-02/">Chapter01-02 PyTorchçš„ç®€ä»‹å’Œå®‰è£…ã€PyTorchåŸºç¡€çŸ¥è¯†</a>
        
    
    </li>
            
        
            
            
                
                
            

             
                <li class="terminal-mkdocs-side-nav-li-ul-li">
    
        
        
            <a class="

    terminal-mkdocs-side-nav-item" href="../pytorch-chap03/">Chapter03 PyTorchçš„ä¸»è¦ç»„æˆæ¨¡å—</a>
        
    
    </li>
            
        
            
            
                
                
            

             
                <li class="terminal-mkdocs-side-nav-li-ul-li">
    
        
        
            <a class="

    terminal-mkdocs-side-nav-item" href="../pytorch-chap04/">Chapter04 PyTorchåŸºç¡€å®æˆ˜â€”â€”FashionMNISTå›¾åƒåˆ†ç±»</a>
        
    
    </li>
            
            
    </ul>
        
    
  </li>
        
          



<li class="terminal-mkdocs-side-nav-li">
    
    
        
        
            
                
        

        
            
    
        
        
            
            
            <span class="
        
            
        
    

    terminal-mkdocs-side-nav-item terminal-mkdocs-side-nav-section-no-index">Nand2Tetris è®¡ç®—æœºç³»ç»Ÿè¦ç´ </span>
        
    
    
        
      
        
            <ul class="terminal-mkdocs-side-nav-li-ul">
        
            
            
                
                
            

             
                <li class="terminal-mkdocs-side-nav-li-ul-li">
    
        
        
            <a class="

    terminal-mkdocs-side-nav-item" href="../../system/nand2tetris_part_1/">Nand2Tetris Part1 (Hardware)</a>
        
    
    </li>
            
        
            
            
                
                
            

             
                <li class="terminal-mkdocs-side-nav-li-ul-li">
    
        
        
            <a class="

    terminal-mkdocs-side-nav-item" href="../../system/nand2tetris_part_2/">Nand2Tetris Part2 (Software)</a>
        
    
    </li>
            
            
    </ul>
        
    
  </li>
        
          



<li class="terminal-mkdocs-side-nav-li">
    
    
        
        
            
                
        

        
            
    
        
        
            
            
            <span class="
        
            
        
    

    terminal-mkdocs-side-nav-item terminal-mkdocs-side-nav-section-no-index">ML Compilation æœºå™¨å­¦ä¹ ç¼–è¯‘</span>
        
    
    
        
      
        
            <ul class="terminal-mkdocs-side-nav-li-ul">
        
            
            
                
                
            

             
                <li class="terminal-mkdocs-side-nav-li-ul-li">
    
        
        
            <a class="

    terminal-mkdocs-side-nav-item" href="../../system/ml-compilation-01/">01 æœºå™¨å­¦ä¹ ç¼–è¯‘æ¦‚è¿°</a>
        
    
    </li>
            
        
            
            
                
                
            

             
                <li class="terminal-mkdocs-side-nav-li-ul-li">
    
        
        
            <a class="

    terminal-mkdocs-side-nav-item" href="../../system/ml-compilation-02/">02 å¼ é‡ç¨‹åºæŠ½è±¡</a>
        
    
    </li>
            
        
            
            
                
                
            

             
                <li class="terminal-mkdocs-side-nav-li-ul-li">
    
        
        
            <a class="

    terminal-mkdocs-side-nav-item" href="../../system/ml-compilation-03/">03 å¼ é‡ç¨‹åºæŠ½è±¡æ¡ˆä¾‹ç ”ç©¶ï¼šTensorIR</a>
        
    
    </li>
            
        
            
            
                
                
            

             
                <li class="terminal-mkdocs-side-nav-li-ul-li">
    
        
        
            <a class="

    terminal-mkdocs-side-nav-item" href="../../system/ml-compilation-04/">04 ç«¯åˆ°ç«¯æ¨¡å‹æ•´åˆ</a>
        
    
    </li>
            
        
            
            
                
                
            

             
                <li class="terminal-mkdocs-side-nav-li-ul-li">
    
        
        
            <a class="

    terminal-mkdocs-side-nav-item" href="../../system/ml-compilation-05/">05 è‡ªåŠ¨ç¨‹åºä¼˜åŒ–</a>
        
    
    </li>
            
            
    </ul>
        
    
  </li>
        
          



<li class="terminal-mkdocs-side-nav-li">
    
    
        
        
            
                
        

        
            
    
        
        
            
            
            <span class="
        
            
        
    

    terminal-mkdocs-side-nav-item terminal-mkdocs-side-nav-section-no-index">Resources</span>
        
    
    
        
      
        
            <ul class="terminal-mkdocs-side-nav-li-ul">
        
            
            
                
                
            

             
                <li class="terminal-mkdocs-side-nav-li-ul-li">
    
        
        
            <a class="

    terminal-mkdocs-side-nav-item" href="../../resource/ml-system-learning-list/">ML System Learning List</a>
        
    
    </li>
            
        
            
            
                
                
            

             
                <li class="terminal-mkdocs-side-nav-li-ul-li">
    
        
        
            <a class="

    terminal-mkdocs-side-nav-item" href="../../resource/open-source-projects/">Open Source Projects</a>
        
    
    </li>
            
        
            
            
                
                
            

             
                <li class="terminal-mkdocs-side-nav-li-ul-li">
    
        
        
            <a class="

    terminal-mkdocs-side-nav-item" href="../../resource/post-types-of-paper/">Types of CS Paper</a>
        
    
    </li>
            
            
    </ul>
        
    
  </li>
        
    </ul>
  
</nav><hr>
<nav>
    <ul>
        <li><a href="#task02-attentiointransformer">Task02 å­¦ä¹ Attentioinå’ŒTransformer</a></li>
        <li><a href="#attention">Attention</a></li>
        <li><a href="#seq2seq">seq2seq</a></li>
        <li><a href="#attention_1">Attention</a></li>
        <li><a href="#transformer">Transformer</a></li>
        <li><a href="#_1">æ¨¡å‹æ¶æ„</a></li>
        <li><a href="#_2">æ¨¡å‹è¾“å…¥</a></li>
        <li><a href="#_3">è¯å‘é‡</a></li>
        <li><a href="#_4">ä½ç½®å‘é‡</a></li>
        <li><a href="#_5">ç¼–ç å™¨å’Œè§£ç å™¨</a></li>
        <li><a href="#self-attention">Self-Attention</a></li>
        <li><a href="#multi-head-self-attention">Multi Head Self-Attention</a></li>
        <li><a href="#_6">æ®‹å·®é“¾æ¥å’Œå½’ä¸€åŒ–</a></li>
        <li><a href="#_7">æ¨¡å‹è¾“å‡º</a></li>
        <li><a href="#softmax">çº¿æ€§å±‚å’Œsoftmax</a></li>
        <li><a href="#_8">æŸå¤±å‡½æ•°</a></li>
        <li><a href="#_9">å‚è€ƒèµ„æ–™</a></li>
        
    </ul>
</nav>
</aside>
            <main id="terminal-mkdocs-main-content">
    
    
    
    
    

<section id="mkdocs-terminal-content">
    <h6 id="task02-attentiointransformer">Task02 å­¦ä¹ Attentioinå’ŒTransformer<a class="headerlink" href="#task02-attentiointransformer" title="Permanent link">&para;</a></h6>
<h6 id="attention">Attention<a class="headerlink" href="#attention" title="Permanent link">&para;</a></h6>
<h6 id="seq2seq">seq2seq<a class="headerlink" href="#seq2seq" title="Permanent link">&para;</a></h6>
<p>seq2seqæ˜¯ä¸€ç§å¸¸è§çš„NLPæ¨¡å‹ç»“æ„ï¼Œå…¨ç§°æ˜¯ï¼šsequence to sequenceï¼Œç¿»è¯‘ä¸ºâ€œåºåˆ—åˆ°åºåˆ—â€ã€‚é¡¾åæ€ä¹‰ï¼šä»ä¸€ä¸ªæ–‡æœ¬åºåˆ—å¾—åˆ°ä¸€ä¸ªæ–°çš„æ–‡æœ¬åºåˆ—ã€‚å…¸å‹çš„ä»»åŠ¡æœ‰ï¼šæœºå™¨ç¿»è¯‘ä»»åŠ¡ï¼Œæ–‡æœ¬æ‘˜è¦ä»»åŠ¡ã€‚</p>
<p>seq2seqæ¨¡å‹ç”±ç¼–ç å™¨ï¼ˆencoderï¼‰å’Œè§£ç å™¨ï¼ˆdecoderï¼‰ç»„æˆï¼Œç¼–ç å™¨ç”¨æ¥åˆ†æè¾“å…¥åºåˆ—ï¼Œè§£ç å™¨ç”¨æ¥ç”Ÿæˆè¾“å‡ºåºåˆ—ã€‚ç¼–ç å™¨ä¼šå¤„ç†è¾“å…¥åºåˆ—ä¸­çš„æ¯ä¸ªå…ƒç´ ï¼ŒæŠŠè¿™äº›ä¿¡æ¯è½¬æ¢æˆä¸ºä¸€ä¸ªèƒŒæ™¯å‘é‡ï¼ˆcontext vectorï¼‰ã€‚å½“æˆ‘ä»¬å¤„ç†å®Œæ•´ä¸ªè¾“å…¥åºåˆ—åï¼Œç¼–ç å™¨æŠŠèƒŒæ™¯å‘é‡å‘é€ç»™è§£ç å™¨ï¼Œè§£ç å™¨é€šè¿‡èƒŒæ™¯å‘é‡ä¸­çš„ä¿¡æ¯ï¼Œé€ä¸ªå…ƒç´ è¾“å‡ºæ–°çš„åºåˆ—ã€‚</p>
<p><strong>åœ¨transformeræ¨¡å‹ä¹‹å‰ï¼Œseq2seqä¸­çš„ç¼–ç å™¨å’Œè§£ç å™¨ä¸€èˆ¬é‡‡ç”¨å¾ªç¯ç¥ç»ç½‘ç»œï¼ˆRNNï¼‰</strong>ï¼Œè™½ç„¶éå¸¸ç»å…¸ï¼Œä½†æ˜¯å±€é™æ€§ä¹Ÿéå¸¸å¤§ã€‚æœ€å¤§çš„å±€é™æ€§å°±åœ¨äºç¼–ç å™¨å’Œè§£ç å™¨ä¹‹é—´çš„å”¯ä¸€è”ç³»å°±æ˜¯ä¸€ä¸ªå›ºå®šé•¿åº¦çš„contextå‘é‡ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œç¼–ç å™¨è¦å°†æ•´ä¸ªåºåˆ—çš„ä¿¡æ¯å‹ç¼©è¿›ä¸€ä¸ªå›ºå®šé•¿åº¦çš„å‘é‡ä¸­ã€‚è¿™æ ·åšå­˜åœ¨ä¸¤ä¸ªå¼Šç«¯ï¼š
- è¯­ä¹‰å‘é‡å¯èƒ½æ— æ³•å®Œå…¨è¡¨ç¤ºæ•´ä¸ªåºåˆ—çš„ä¿¡æ¯
- å…ˆè¾“å…¥åˆ°ç½‘ç»œçš„å†…å®¹æºå¸¦çš„ä¿¡æ¯ä¼šè¢«åè¾“å…¥çš„ä¿¡æ¯è¦†ç›–æ‰ï¼Œè¾“å…¥åºåˆ—è¶Šé•¿ï¼Œè¿™ä¸ªç°è±¡å°±è¶Šä¸¥é‡</p>
<h6 id="attention_1">Attention<a class="headerlink" href="#attention_1" title="Permanent link">&para;</a></h6>
<p>ä¸ºäº†è§£å†³seq2seqæ¨¡å‹ä¸­çš„ä¸¤ä¸ªå¼Šç«¯ï¼ŒBahdanauç­‰äººåœ¨è®ºæ–‡ã€ŠNeural Machine Translation by Jointly Learning to Align and Translateã€‹ä¸­æå‡ºä½¿ç”¨Attentionæœºåˆ¶ï¼Œä½¿å¾—seq2seqæ¨¡å‹å¯ä»¥æœ‰åŒºåˆ†åº¦ã€æœ‰é‡ç‚¹åœ°å…³æ³¨è¾“å…¥åºåˆ—ï¼Œä»è€Œæå¤§åœ°æé«˜äº†æœºå™¨ç¿»è¯‘çš„è´¨é‡ã€‚</p>
<p>ä¸€ä¸ªæœ‰æ³¨æ„åŠ›æœºåˆ¶çš„seq2seqä¸ç»å…¸çš„seq2seqä¸»è¦æœ‰2ç‚¹ä¸åŒï¼š
1. é¦–å…ˆï¼Œç¼–ç å™¨ä¼šæŠŠæ›´å¤šçš„æ•°æ®ä¼ é€’ç»™è§£ç å™¨ã€‚ç¼–ç å™¨æŠŠæ‰€æœ‰æ—¶é—´æ­¥çš„ hidden stateï¼ˆéšè—å±‚çŠ¶æ€ï¼‰ä¼ é€’ç»™è§£ç å™¨ï¼Œè€Œä¸æ˜¯åªä¼ é€’æœ€åä¸€ä¸ª hidden stateï¼ˆéšè—å±‚çŠ¶æ€ï¼‰
2. æ³¨æ„åŠ›æ¨¡å‹çš„è§£ç å™¨åœ¨äº§ç”Ÿè¾“å‡ºä¹‹å‰ï¼Œåšäº†ä¸€ä¸ªé¢å¤–çš„attentionå¤„ç†</p>
<h6 id="transformer">Transformer<a class="headerlink" href="#transformer" title="Permanent link">&para;</a></h6>
<h6 id="_1">æ¨¡å‹æ¶æ„<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h6>
<p>transformeråŸè®ºæ–‡çš„æ¶æ„å›¾ï¼š</p>
<p><img src="https://github.com/chuxiaoyu/blog_image/blob/master/nlp/trm_1.png?raw=true" width="400" alt="" align="center" /></p>
<p>ä¸€ä¸ªæ›´æ¸…æ™°çš„æ¶æ„å›¾ï¼š
<img src="https://github.com/chuxiaoyu/blog_image/blob/master/nlp/trm_2.png?raw=true" width="600" alt="" align="center" /></p>
<p>ä»è¾“å…¥åˆ°è¾“å‡ºæ‹†å¼€çœ‹å°±æ˜¯ï¼š
- INPUTï¼šinput vector + position encoding
- ENCODERsï¼ˆÃ—6ï¼‰ï¼Œand each encoder includesï¼š
  - input
  - multi-head self-attention
  - residual connection&amp;norm
  - full-connected network
  - residual connection&amp;norm
  - output
- DECODERsï¼ˆÃ—6ï¼‰ï¼Œand each decoder includesï¼š
  - input 
  - Masked multihead self-attention
  - residual connection&amp;norm
  - multi-head self-attention
  - residual connection&amp;norm
  - full-connected network
  - residual connection&amp;norm
  - output
- OUTPUTï¼š
  - output (decoder's)
  - linear layer
  - softmax layer
  - output</p>
<h6 id="_2">æ¨¡å‹è¾“å…¥<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h6>
<h6 id="_3">è¯å‘é‡<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h6>
<p>å’Œå¸¸è§çš„NLPä»»åŠ¡ä¸€æ ·ï¼Œæˆ‘ä»¬é¦–å…ˆä¼šä½¿ç”¨è¯åµŒå…¥ç®—æ³•ï¼ˆembeddingï¼‰ï¼Œå°†è¾“å…¥æ–‡æœ¬åºåˆ—çš„æ¯ä¸ªè¯è½¬æ¢ä¸ºä¸€ä¸ªè¯å‘é‡ã€‚</p>
<h6 id="_4">ä½ç½®å‘é‡<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h6>
<p>Transformeræ¨¡å‹å¯¹æ¯ä¸ªè¾“å…¥çš„è¯å‘é‡éƒ½åŠ ä¸Šäº†ä¸€ä¸ªä½ç½®å‘é‡ã€‚è¿™äº›å‘é‡æœ‰åŠ©äºç¡®å®šæ¯ä¸ªå•è¯çš„ä½ç½®ç‰¹å¾ï¼Œæˆ–è€…å¥å­ä¸­ä¸åŒå•è¯ä¹‹é—´çš„è·ç¦»ç‰¹å¾ã€‚è¯å‘é‡åŠ ä¸Šä½ç½®å‘é‡èƒŒåçš„ç›´è§‰æ˜¯ï¼šå°†è¿™äº›è¡¨ç¤ºä½ç½®çš„å‘é‡æ·»åŠ åˆ°è¯å‘é‡ä¸­ï¼Œå¾—åˆ°çš„æ–°å‘é‡ï¼Œå¯ä»¥ä¸ºæ¨¡å‹æä¾›æ›´å¤šæœ‰æ„ä¹‰çš„ä¿¡æ¯ï¼Œæ¯”å¦‚è¯çš„ä½ç½®ï¼Œè¯ä¹‹é—´çš„è·ç¦»ç­‰ã€‚</p>
<p><em>ï¼ˆç”Ÿæˆä½ç½®ç¼–ç å‘é‡çš„æ–¹æ³•æœ‰å¾ˆå¤šç§ï¼‰</em></p>
<h6 id="_5">ç¼–ç å™¨å’Œè§£ç å™¨<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h6>
<p><em>æ³¨ï¼š1. ç¼–ç å™¨å’Œè§£ç å™¨ä¸­æœ‰ç›¸ä¼¼çš„æ¨¡å—å’Œç»“æ„ï¼Œæ‰€ä»¥åˆå¹¶åˆ°ä¸€èµ·ä»‹ç»ã€‚</em>
<em>2. æœ¬éƒ¨åˆ†æŒ‰ç…§æå®æ¯…è€å¸ˆçš„Attentionï¼ŒTransformeréƒ¨åˆ†çš„è¯¾ç¨‹PPTæ¥ï¼Œå› ä¸ºleeçš„è¯¾ç¨‹å¯¹æ–°æ‰‹æ›´å‹å¥½ã€‚</em></p>
<h6 id="self-attention">Self-Attention<a class="headerlink" href="#self-attention" title="Permanent link">&para;</a></h6>
<p>self-attentionå¯¹äºæ¯ä¸ªå‘é‡éƒ½ä¼šè€ƒè™‘æ•´ä¸ªsequenceçš„ä¿¡æ¯åè¾“å‡ºä¸€ä¸ªå‘é‡ï¼Œself-attentionç»“æ„å¦‚ä¸‹ï¼š
<img src="https://github.com/chuxiaoyu/blog_image/blob/master/nlp/04_attention_1.png?raw=true" width="600" alt="" align="center" />
FCï¼šFully-connected network å…¨è¿æ¥ç½‘ç»œ
ai: è¾“å…¥å˜é‡ã€‚å¯èƒ½æ˜¯æ•´ä¸ªç½‘ç»œçš„è¾“å…¥ï¼Œä¹Ÿå¯èƒ½æ˜¯æŸä¸ªéšè—å±‚çš„è¾“å‡º
bi: è€ƒè™‘æ•´ä¸ªsequenceä¿¡æ¯åçš„è¾“å‡ºå˜é‡</p>
<p>çŸ©é˜µè®¡ç®—ï¼š
<img src="https://github.com/chuxiaoyu/blog_image/blob/master/nlp/13_matrix_4.jpg?raw=true" width="300" alt="" align="center" />
ç›®æ ‡ï¼šæ ¹æ®è¾“å…¥å‘é‡çŸ©é˜µIï¼Œè®¡ç®—è¾“å‡ºå‘é‡çŸ©é˜µOã€‚çŸ©é˜µè¿ç®—è¿‡ç¨‹ï¼š
1. çŸ©é˜µIåˆ†åˆ«ä¹˜ä»¥Wq, Wk, Wvï¼ˆå‚æ•°çŸ©é˜µï¼Œéœ€è¦æ¨¡å‹è¿›è¡Œå­¦ä¹ ï¼‰ï¼Œå¾—åˆ°çŸ©é˜µQ, K, Vã€‚
2. çŸ©é˜µKçš„è½¬ç½®ä¹˜ä»¥Qï¼Œå¾—åˆ°æ³¨æ„åŠ›æƒé‡çŸ©é˜µAï¼Œå½’ä¸€åŒ–å¾—åˆ°çŸ©é˜µAâ€™ã€‚
3. çŸ©é˜µVä¹˜çŸ©é˜µAâ€˜ï¼Œå¾—åˆ°è¾“å‡ºå‘é‡çŸ©é˜µOã€‚</p>
<h6 id="multi-head-self-attention">Multi Head Self-Attention<a class="headerlink" href="#multi-head-self-attention" title="Permanent link">&para;</a></h6>
<p><em>ç®€å•åœ°è¯´ï¼Œå¤šäº†å‡ ç»„Qï¼ŒKï¼ŒVã€‚åœ¨Self-Attentionä¸­ï¼Œæˆ‘ä»¬æ˜¯ä½¿ç”¨ğ‘å»å¯»æ‰¾ä¸ä¹‹ç›¸å…³çš„ğ‘˜ï¼Œä½†æ˜¯è¿™ä¸ªç›¸å…³æ€§å¹¶ä¸ä¸€å®šæœ‰ä¸€ç§ã€‚é‚£å¤šç§ç›¸å…³æ€§ä½“ç°åˆ°è®¡ç®—æ–¹å¼ä¸Šå°±æ˜¯æœ‰å¤šä¸ªçŸ©é˜µğ‘ï¼Œä¸åŒçš„ğ‘è´Ÿè´£ä»£è¡¨ä¸åŒçš„ç›¸å…³æ€§ã€‚</em></p>
<p>Transformer çš„è®ºæ–‡é€šè¿‡å¢åŠ å¤šå¤´æ³¨æ„åŠ›æœºåˆ¶ï¼ˆä¸€ç»„æ³¨æ„åŠ›ç§°ä¸ºä¸€ä¸ª attention headï¼‰ï¼Œè¿›ä¸€æ­¥å®Œå–„äº†Self-Attentionã€‚è¿™ç§æœºåˆ¶ä»å¦‚ä¸‹ä¸¤ä¸ªæ–¹é¢å¢å¼ºäº†attentionå±‚çš„èƒ½åŠ›ï¼š
- å®ƒæ‰©å±•äº†æ¨¡å‹å…³æ³¨ä¸åŒä½ç½®çš„èƒ½åŠ›ã€‚
- å¤šå¤´æ³¨æ„åŠ›æœºåˆ¶èµ‹äºˆattentionå±‚å¤šä¸ªâ€œå­è¡¨ç¤ºç©ºé—´â€ã€‚</p>
<h6 id="_6">æ®‹å·®é“¾æ¥å’Œå½’ä¸€åŒ–<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h6>
<p>æ®‹å·®é“¾æ¥ï¼šä¸€ç§æŠŠinputå‘é‡å’Œoutputå‘é‡ç›´æ¥åŠ èµ·æ¥çš„æ¶æ„ã€‚
å½’ä¸€åŒ–ï¼šæŠŠæ•°æ®æ˜ å°„åˆ°0ï½1èŒƒå›´ä¹‹å†…å¤„ç†ã€‚</p>
<h6 id="_7">æ¨¡å‹è¾“å‡º<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h6>
<h6 id="softmax">çº¿æ€§å±‚å’Œsoftmax<a class="headerlink" href="#softmax" title="Permanent link">&para;</a></h6>
<p>Decoder æœ€ç»ˆçš„è¾“å‡ºæ˜¯ä¸€ä¸ªå‘é‡ï¼Œå…¶ä¸­æ¯ä¸ªå…ƒç´ æ˜¯æµ®ç‚¹æ•°ã€‚æˆ‘ä»¬æ€ä¹ˆæŠŠè¿™ä¸ªå‘é‡è½¬æ¢ä¸ºå•è¯å‘¢ï¼Ÿè¿™æ˜¯çº¿æ€§å±‚å’Œsoftmaxå®Œæˆçš„ã€‚</p>
<p>çº¿æ€§å±‚å°±æ˜¯ä¸€ä¸ªæ™®é€šçš„å…¨è¿æ¥ç¥ç»ç½‘ç»œï¼Œå¯ä»¥æŠŠè§£ç å™¨è¾“å‡ºçš„å‘é‡ï¼Œæ˜ å°„åˆ°ä¸€ä¸ªæ›´å¤§çš„å‘é‡ï¼Œè¿™ä¸ªå‘é‡ç§°ä¸º logits å‘é‡ï¼šå‡è®¾æˆ‘ä»¬çš„æ¨¡å‹æœ‰ 10000 ä¸ªè‹±è¯­å•è¯ï¼ˆæ¨¡å‹çš„è¾“å‡ºè¯æ±‡è¡¨ï¼‰ï¼Œæ­¤ logits å‘é‡ä¾¿ä¼šæœ‰ 10000 ä¸ªæ•°å­—ï¼Œæ¯ä¸ªæ•°è¡¨ç¤ºä¸€ä¸ªå•è¯çš„åˆ†æ•°ã€‚</p>
<p>ç„¶åï¼ŒSoftmax å±‚ä¼šæŠŠè¿™äº›åˆ†æ•°è½¬æ¢ä¸ºæ¦‚ç‡ï¼ˆæŠŠæ‰€æœ‰çš„åˆ†æ•°è½¬æ¢ä¸ºæ­£æ•°ï¼Œå¹¶ä¸”åŠ èµ·æ¥ç­‰äº 1ï¼‰ã€‚ç„¶åé€‰æ‹©æœ€é«˜æ¦‚ç‡çš„é‚£ä¸ªæ•°å­—å¯¹åº”çš„è¯ï¼Œå°±æ˜¯è¿™ä¸ªæ—¶é—´æ­¥çš„è¾“å‡ºå•è¯ã€‚</p>
<h6 id="_8">æŸå¤±å‡½æ•°<a class="headerlink" href="#_8" title="Permanent link">&para;</a></h6>
<p>Transformerè®­ç»ƒçš„æ—¶å€™ï¼Œéœ€è¦å°†è§£ç å™¨çš„è¾“å‡ºå’Œlabelä¸€åŒé€å…¥æŸå¤±å‡½æ•°ï¼Œä»¥è·å¾—lossï¼Œæœ€ç»ˆæ¨¡å‹æ ¹æ®lossè¿›è¡Œæ–¹å‘ä¼ æ’­ã€‚</p>
<p>åªè¦Transformerè§£ç å™¨é¢„æµ‹äº†ç»„æ¦‚ç‡ï¼Œæˆ‘ä»¬å°±å¯ä»¥æŠŠè¿™ç»„æ¦‚ç‡å’Œæ­£ç¡®çš„è¾“å‡ºæ¦‚ç‡åšå¯¹æ¯”ï¼Œç„¶åä½¿ç”¨åå‘ä¼ æ’­æ¥è°ƒæ•´æ¨¡å‹çš„æƒé‡ï¼Œä½¿å¾—è¾“å‡ºçš„æ¦‚ç‡åˆ†å¸ƒæ›´åŠ æ¥è¿‘æ•´æ•°è¾“å‡ºã€‚</p>
<p>é‚£æˆ‘ä»¬è¦æ€ä¹ˆæ¯”è¾ƒä¸¤ä¸ªæ¦‚ç‡åˆ†å¸ƒå‘¢ï¼Ÿï¼šæˆ‘ä»¬å¯ä»¥ç®€å•çš„ç”¨ä¸¤ç»„æ¦‚ç‡å‘é‡çš„çš„ç©ºé—´è·ç¦»ä½œä¸ºlossï¼ˆå‘é‡ç›¸å‡ï¼Œç„¶åæ±‚å¹³æ–¹å’Œï¼Œå†å¼€æ–¹ï¼‰ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ä½¿ç”¨äº¤å‰ç†µ(cross-entropy)]å’ŒKL æ•£åº¦(Kullbackâ€“Leibler divergence)ã€‚</p>
<h6 id="_9">å‚è€ƒèµ„æ–™<a class="headerlink" href="#_9" title="Permanent link">&para;</a></h6>
<p><strong>ç†è®ºéƒ¨åˆ†</strong>
[1] (å¼ºæ¨)æå®æ¯…2021æ˜¥æœºå™¨å­¦ä¹ è¯¾ç¨‹ <a href="https://www.bilibili.com/video/BV1Wv411h7kN?from=search&amp;seid=17090062977285779802&amp;spm_id_from=333.337.0.0">https://www.bilibili.com/video/BV1Wv411h7kN?from=search&amp;seid=17090062977285779802&amp;spm_id_from=333.337.0.0</a>
[2] <strong>åŸºäºtransformersçš„è‡ªç„¶è¯­è¨€å¤„ç†(NLP)å…¥é—¨ï¼ˆæ¶µç›–äº†å›¾è§£ç³»åˆ—ã€annotated transformerã€huggingfaceï¼‰</strong> <a href="https://github.com/datawhalechina/learn-nlp-with-transformers">https://github.com/datawhalechina/learn-nlp-with-transformers</a>
[3] å›¾è§£transformer|The Illustrated Transformer <a href="http://jalammar.github.io/illustrated-transformer/">http://jalammar.github.io/illustrated-transformer/</a>
[4] å›¾è§£seq2seq, attention|Visualizing A Neural Machine Translation Model (Mechanics of Seq2seq Models With Attention) <a href="https://jalammar.github.io/visualizing-neural-machine-translation-mechanics-of-seq2seq-models-with-attention/">https://jalammar.github.io/visualizing-neural-machine-translation-mechanics-of-seq2seq-models-with-attention/</a></p>
<p><strong>ä»£ç éƒ¨åˆ†</strong>
[5] The Annotated Transformer <a href="http://nlp.seas.harvard.edu//2018/04/03/attention.html">http://nlp.seas.harvard.edu//2018/04/03/attention.html</a>
[6] Huggingface/transformers <a href="https://github.com/huggingface/transformers/blob/master/README_zh-hans.md">https://github.com/huggingface/transformers/blob/master/README_zh-hans.md</a></p>
<p><strong>è®ºæ–‡éƒ¨åˆ†</strong>
Attention is all "we" need.</p>
<p><strong>å…¶ä»–ä¸é”™çš„åšå®¢æˆ–æ•™ç¨‹</strong>
[7] åŸºäºtransformersçš„è‡ªç„¶è¯­è¨€å¤„ç†(NLP)å…¥é—¨--åœ¨çº¿é˜…è¯» <a href="https://datawhalechina.github.io/learn-nlp-with-transformers/#/">https://datawhalechina.github.io/learn-nlp-with-transformers/#/</a>
[8] æå®æ¯…2021æ˜¥æœºå™¨å­¦ä¹ è¯¾ç¨‹ç¬”è®°â€”â€”è‡ªæ³¨æ„åŠ›æœºåˆ¶ <a href="https://www.cnblogs.com/sykline/p/14730088.html">https://www.cnblogs.com/sykline/p/14730088.html</a>
[9] æå®æ¯…2021æ˜¥æœºå™¨å­¦ä¹ è¯¾ç¨‹ç¬”è®°â€”â€”Transformeræ¨¡å‹ <a href="https://www.cnblogs.com/sykline/p/14785552.html">https://www.cnblogs.com/sykline/p/14785552.html</a>
[10] æå®æ¯…æœºå™¨å­¦ä¹ å­¦ä¹ ç¬”è®°â€”â€”è‡ªæ³¨æ„åŠ›æœºåˆ¶ <a href="https://blog.csdn.net/p_memory/article/details/116271274">https://blog.csdn.net/p_memory/article/details/116271274</a>
[11] è½¦ä¸‡ç¿”-è‡ªç„¶è¯­è¨€å¤„ç†æ–°èŒƒå¼ï¼šåŸºäºé¢„è®­ç»ƒçš„æ–¹æ³•ã€è®²åº§+PPTã€‘ <a href="https://app6ca5octe2206.pc.xiaoe-tech.com/detail/v_611f48f3e4b02ac39d12246f/3?fromH5=true">https://app6ca5octe2206.pc.xiaoe-tech.com/detail/v_611f48f3e4b02ac39d12246f/3?fromH5=true</a>
[12] è‹å‰‘æ—-ã€ŠAttention is All You Needã€‹æµ…è¯»ï¼ˆç®€ä»‹+ä»£ç ï¼‰<a href="https://spaces.ac.cn/archives/4765">https://spaces.ac.cn/archives/4765</a></p>
</section>

<section id="mkdocs-terminal-after-content">
    
</section>
<section id="mkdocs-terminal-revision">
<br>
<aside>
    <p>
        <small>
            <i>Page last updated 2023-12-10. </i>
        </small>
    </p>
</aside>
</section>
            </main>
        </div>
        <hr><footer>
    <div class="terminal-mkdocs-footer-grid">
        <div id="terminal-mkdocs-footer-copyright-info">
            
            <p class="text-center text-muted">&copy; 2022-2023 by <a href='https://chuxiaoyu.github.io/' target='_blank'> Xiaoyu Chu </a></p>
             Site built with <a href="http://www.mkdocs.org">MkDocs</a> and <a href="https://github.com/ntno/mkdocs-terminal">Terminal for MkDocs</a>.
        </div>
        <div id="terminal-mkdocs-footer-prev-next">
            <nav class="btn-group">
                <a href="../nlp-transformer-task01/" title="Task01 NLPå­¦ä¹ æ¦‚è§ˆ">Previous</a>
                |
                <a href="../nlp-transformer-task03/" title="Task03 å­¦ä¹ BERT">Next</a>
            </nav>
        </div>
    </div>
</footer>
    </div>

    
    <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="alertdialog" aria-modal="true" aria-labelledby="searchModalLabel">
    <div class="modal-dialog modal-lg" role="search">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="searchModalLabel">Search</h5>
                <button type="button" class="close btn btn-default btn-ghost" data-dismiss="modal"><span aria-hidden="true">x</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p id="searchInputLabel">Type to start searching</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" aria-labelledby="searchInputLabel" placeholder="" id="mkdocs-search-query" title="Please enter search terms here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No document matches found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>
    
    
</body>

</html>