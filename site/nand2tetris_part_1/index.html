
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../image/logo.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-8.1.2">
    
    
      
        <title>Nand2Tetris Part1 (Hardware) - Xiaoyu's Blog</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.f7951f6f.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.e6a45f82.min.css">
        
          
          
          <meta name="theme-color" content="#000000">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Serif+Pro:300,400,400i,700%7C&display=fallback">
        <style>:root{--md-text-font:"Source Serif Pro";--md-code-font:""}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="black" data-md-color-accent="">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#nand2tetris-part1" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Xiaoyu&#39;s Blog" class="md-header__button md-logo" aria-label="Xiaoyu's Blog" data-md-component="logo">
      
  <img src="../image/logo2.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Xiaoyu's Blog
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Nand2Tetris Part1 (Hardware)
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/chuxiaoyu/blog/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    chuxiaoyu/blog
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href=".." class="md-tabs__link">
      Home
    </a>
  </li>

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../ml-index/" class="md-tabs__link">
        Machine Learning
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../sys-index/" class="md-tabs__link md-tabs__link--active">
        Computer Systems
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../open-source-projects/" class="md-tabs__link">
        Posts
      </a>
    </li>
  

      
        
  
  


  <li class="md-tabs__item">
    <a href="https://www.chuxiaoyu.cn/" class="md-tabs__link">
      About
    </a>
  </li>

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Xiaoyu&#39;s Blog" class="md-nav__button md-logo" aria-label="Xiaoyu's Blog" data-md-component="logo">
      
  <img src="../image/logo2.png" alt="logo">

    </a>
    Xiaoyu's Blog
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/chuxiaoyu/blog/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    chuxiaoyu/blog
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Machine Learning
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Machine Learning" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Machine Learning
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ml-index/" class="md-nav__link">
        目录
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_2" type="checkbox" id="__nav_2_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2_2">
          CS224n自然语言处理
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="CS224n自然语言处理" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_2">
          <span class="md-nav__icon md-icon"></span>
          CS224n自然语言处理
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Lecture07/" class="md-nav__link">
        Lecture07 机器翻译、seq2seq模型、注意力机制
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Lecture09/" class="md-nav__link">
        Lecture09 自注意力模型、Transformers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Lecture10/" class="md-nav__link">
        Lecture10 预训练
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Lecture11/" class="md-nav__link">
        Lecture11 问答系统
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_3" type="checkbox" id="__nav_2_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2_3">
          基于transformers的NLP
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="基于transformers的NLP" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_3">
          <span class="md-nav__icon md-icon"></span>
          基于transformers的NLP
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../nlp-transformer-task01/" class="md-nav__link">
        Task01 NLP学习概览
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../nlp-transformer-task02/" class="md-nav__link">
        Task02 学习Attentioin和Transformer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../nlp-transformer-task03/" class="md-nav__link">
        Task03 学习BERT
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../nlp-transformer-task04/" class="md-nav__link">
        Task04 学习GPT
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../nlp-transformer-task05/" class="md-nav__link">
        Task05 编写BERT模型
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../nlp-transformer-task06/" class="md-nav__link">
        Task06 BERT应用、训练和优化
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../nlp-transformer-task07/" class="md-nav__link">
        Task07 使用Transformers解决文本分类任务
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_4" type="checkbox" id="__nav_2_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2_4">
          深入浅出PyTorch
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="深入浅出PyTorch" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_4">
          <span class="md-nav__icon md-icon"></span>
          深入浅出PyTorch
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../pytorch-chap01-02/" class="md-nav__link">
        Chapter01-02 PyTorch的简介和安装、PyTorch基础知识
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../pytorch-chap03/" class="md-nav__link">
        Chapter03 PyTorch的主要组成模块
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../pytorch-chap04/" class="md-nav__link">
        Chapter04 PyTorch基础实战——FashionMNIST图像分类
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Computer Systems
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Computer Systems" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Computer Systems
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sys-index/" class="md-nav__link">
        目录
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_2" type="checkbox" id="__nav_3_2" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_3_2">
          Nand2Tetris 计算机系统要素
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Nand2Tetris 计算机系统要素" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_2">
          <span class="md-nav__icon md-icon"></span>
          Nand2Tetris 计算机系统要素
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Nand2Tetris Part1 (Hardware)
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Nand2Tetris Part1 (Hardware)
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    介绍
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#123" class="md-nav__link">
    第1、2、3章 布尔逻辑、布尔运算、时序逻辑
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4" class="md-nav__link">
    第4章 机器语言
  </a>
  
    <nav class="md-nav" aria-label="第4章 机器语言">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    机器语言、汇编
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    内存访问命令、寻址方式、流程控制/分支
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hack-language" class="md-nav__link">
    Hack Language规范和实现
  </a>
  
    <nav class="md-nav" aria-label="Hack Language规范和实现">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a-" class="md-nav__link">
    A指令 - 地址指令
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#c-" class="md-nav__link">
    C指令 - 计算指令
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5" class="md-nav__link">
    第5章 计算机体系结构
  </a>
  
    <nav class="md-nav" aria-label="第5章 计算机体系结构">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    基本结构：冯诺依曼架构
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cpu" class="md-nav__link">
    CPU电路图
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cpu_1" class="md-nav__link">
    CPU抽象
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    计算机抽象
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6" class="md-nav__link">
    第6章 汇编编译器
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../nand2tetris_part_2/" class="md-nav__link">
        Nand2Tetris Part2 (Software)
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_3" type="checkbox" id="__nav_3_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_3">
          ML Compilation 机器学习编译
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="ML Compilation 机器学习编译" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_3">
          <span class="md-nav__icon md-icon"></span>
          ML Compilation 机器学习编译
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ml-compilation-01/" class="md-nav__link">
        01 机器学习编译概述
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ml-compilation-02/" class="md-nav__link">
        02 张量程序抽象
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Posts
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Posts" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Posts
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../open-source-projects/" class="md-nav__link">
        Open Source Projects
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="https://www.chuxiaoyu.cn/" class="md-nav__link">
        About
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    介绍
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#123" class="md-nav__link">
    第1、2、3章 布尔逻辑、布尔运算、时序逻辑
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4" class="md-nav__link">
    第4章 机器语言
  </a>
  
    <nav class="md-nav" aria-label="第4章 机器语言">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    机器语言、汇编
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    内存访问命令、寻址方式、流程控制/分支
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hack-language" class="md-nav__link">
    Hack Language规范和实现
  </a>
  
    <nav class="md-nav" aria-label="Hack Language规范和实现">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a-" class="md-nav__link">
    A指令 - 地址指令
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#c-" class="md-nav__link">
    C指令 - 计算指令
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5" class="md-nav__link">
    第5章 计算机体系结构
  </a>
  
    <nav class="md-nav" aria-label="第5章 计算机体系结构">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    基本结构：冯诺依曼架构
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cpu" class="md-nav__link">
    CPU电路图
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cpu_1" class="md-nav__link">
    CPU抽象
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    计算机抽象
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6" class="md-nav__link">
    第6章 汇编编译器
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
<a href="https://github.com/chuxiaoyu/blog/edit/master/docs/nand2tetris_part_1.md" title="Edit this page" class="md-content__button md-icon">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
</a>


<h1 id="nand2tetris-part1">Nand2Tetris Part1 (硬件)<a class="headerlink" href="#nand2tetris-part1" title="Permanent link">&para;</a></h1>
<h2 id="_1">介绍<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<p>课程官网：<a href="https://www.nand2tetris.org/">https://www.nand2tetris.org/</a></p>
<p>Nand2Tetris（全称《依据基本原理构建现代计算机：从与非门到俄罗斯方块》）分为两部分：硬件和软件。</p>
<p><img alt="image-20220518224916784" src="../image/image-20220518224916784.png" /></p>
<p>硬件（PART1）的课程作业包括6个项目（其中P4和P6属于编程项目，其他都是硬件构建项目）：</p>
<ul>
<li>项目1：构建初级逻辑门，如And, Or, Not, Multiplexor等</li>
<li>项目2：构建一个加法器（Full-Adder）芯片系列，最终构建一个算术逻辑单元（ALU）</li>
<li>项目3：构建寄存器（Register）和存储单元（Memory），最终构建一个随机存取存储器（RAM）</li>
<li>项目4：学习机器语言（Machine Langage）并使用它来编写一些说明性的低级程序（即汇编语言）</li>
<li>项目5：使用项目1-3中建立的芯片组，构建一个中央处理器（CPU）和一个硬件平台（Computer），能够执行项目4中介绍的机器语言编写的程序</li>
<li>项目6：开发一个汇编（Assembler）程序，把用符号机器语言编写的程序翻译成二进制可执行代码</li>
</ul>
<p>硬件项目结构如图：</p>
<p><img alt="image-20220513172932836" src="../image/image-20220513172932836.png" /></p>
<h2 id="123">第1、2、3章 布尔逻辑、布尔运算、时序逻辑<a class="headerlink" href="#123" title="Permanent link">&para;</a></h2>
<p>第1-3章主要是介绍ALU和寄存器的原理和构建。</p>
<p><img alt="image-20220513172932836" src="../image/compArch.png" /></p>
<h2 id="4">第4章 机器语言<a class="headerlink" href="#4" title="Permanent link">&para;</a></h2>
<h3 id="_2">机器语言、汇编<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h3>
<p>【机器语言】机器语言是计算机直接识别的**二进制代码**。机器语言是硬件和软件相接的中间线。</p>
<p>【符号表示】【助记符】程序员用符号指令表达的抽象思维被转换成执行在硅片上的物理操作。</p>
<p>【指令】【指令集】机器语言程序是一系列的**编码指令**。因为不同计算机在CPU的操作方式、寄存器数量和类型以及汇编语法上各不相同，所以有各自的语法，然而所有的机器语言都支持相似的**通用命令集合**。</p>
<p>【汇编语言/Assembly Language】【汇编编译器/Assembler】符号表示也成为汇编语言，将汇编程序翻译成二进制码的程序则称为汇编编译器。</p>
<h3 id="_3">内存访问命令、寻址方式、流程控制/分支<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h3>
<p>【内存访问命令】</p>
<ol>
<li>算术和逻辑命令：不仅允许操纵寄存器，而且还可以操纵特定的内存单元。</li>
<li>load和store命令：用来在寄存器和内存之间传递数据。</li>
</ol>
<p>【寻址方式】</p>
<ul>
<li>
<p>直接寻址/Direct Addressing：直接表示一个指定内存单元的地址。</p>
</li>
<li>
<p>LOAD R1, 67 // R1 ← Memory[67]</p>
</li>
<li>
<p>LOAD R1, bar //   R1 ← Memory[67] 假设bar指向内存地址67</p>
</li>
<li>
<p>立即寻址/Immediate Addressing：被用来加载常数，加载那些出现在指令代码里的数值，直接将数据装入寄存器，而不是将其当作内存单元的地址。</p>
</li>
<li>
<p>LOADI R1, 67 // R1 ← 67 将67加载到寄存器R1中</p>
</li>
<li>
<p>间接寻址/Indirect Addressing：地址没有直接出现在指令中，而是指定内存单元的内容代表地址。被用来处理指针。</p>
</li>
<li>
<p>（高级语言）x=foo[j] or x=*(foo+j) // foo是数组变量，x和j是整数变量；当数组foo在高级语言程序里被声明并初始化时，编译器分配一组连续的内存单元来保存这个数组数据，并用符号foo来指代该内存单元组的基地址（base address）；当编译器遇到foo[j]时，该地址相对于数组基地址的偏移量为j，所以在C中x=foo[j] or x=*(foo+j)等价，*n代表memory[n]。</p>
</li>
<li>
<p>（汇编语言）</p>
<p>ADD R1, foo, j // R1 ← foo+j 将内存地址foo+j添加到R1中</p>
<p>LOAD* R2, R1 // R2 ← Memory[R1] 将R1表示的内存地址中的值加载到R2中</p>
<p>STR R2, x // x ← R2 将R2中的值用符号x表示</p>
</li>
</ul>
<p>【控制流程】【分支】</p>
<ul>
<li>反复：跳回到循环的初始位置</li>
<li>有条件执行：跳到前面的位置（如if-then）</li>
<li>子程序调用：跳到另一代码段的第一条命令</li>
<li>无条件跳转：直接跳转</li>
</ul>
<h3 id="hack-language">Hack Language规范和实现<a class="headerlink" href="#hack-language" title="Permanent link">&para;</a></h3>
<p>【内存地址空间】内存中有两种不同的地址空间：指令地址空间和数据地址空间，简称指令内存和数据内存。CPU仅能执行存储在指令内存中的程序。</p>
<p>【寄存器】</p>
<ul>
<li>D：数据寄存器，储存数据值。</li>
<li>A：既可以作为数据寄存器，也可以作为地址寄存器。储存【数值】或【数据内存中的地址】或【指令内存中的地址】。</li>
<li>M: RAM</li>
</ul>
<p>【@value】value可以是数值或是代表数值的符号，表示将特定的值存到A寄存器中。</p>
<h4 id="a-">A指令 - 地址指令<a class="headerlink" href="#a-" title="Permanent link">&para;</a></h4>
<p><img alt="image-20220512153525383" src="../image/image-20220512153525383.png" /></p>
<p><img alt="image-20220512155721721" src="../image/image-20220512155721721.png" /></p>
<h4 id="c-">C指令 - 计算指令<a class="headerlink" href="#c-" title="Permanent link">&para;</a></h4>
<p><img alt="image-20220512155926658" src="../image/image-20220512155926658.png" /></p>
<p>dest = comp; jump</p>
<h2 id="5">第5章 计算机体系结构<a class="headerlink" href="#5" title="Permanent link">&para;</a></h2>
<h3 id="_4">基本结构：冯诺依曼架构<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h3>
<p><img alt="image-20220512133801144" src="../image/image-20220512133801144.png" /></p>
<h3 id="cpu">CPU电路图<a class="headerlink" href="#cpu" title="Permanent link">&para;</a></h3>
<p><img alt="image-20220512135327703" src="../image/image-20220512135327703.png" /></p>
<h3 id="cpu_1">CPU抽象<a class="headerlink" href="#cpu_1" title="Permanent link">&para;</a></h3>
<p><img alt="image-20220513165256412" src="../image/image-20220513165256412.png" /></p>
<h3 id="_5">计算机抽象<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h3>
<p><img alt="image-20220518232945219" src="../image/image-20220518232945219.png" /></p>
<h2 id="6">第6章 汇编编译器<a class="headerlink" href="#6" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">input: Prog.asm (assembly code)</span>
<span class="sd">output: Prog.hack (binary code)</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="k">def</span> <span class="nf">Parser</span><span class="p">(</span><span class="n">asmFile</span><span class="p">):</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">asmFile</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">asmLines</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
    <span class="n">parsedLines</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">asmLines</span><span class="p">:</span>
        <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">line</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;//&quot;</span><span class="p">):</span>
                <span class="k">if</span> <span class="s2">&quot;//&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                    <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;//&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                    <span class="n">parsedLines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">parsedLines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">parsedLines</span>


<span class="k">def</span> <span class="nf">symbolTable</span><span class="p">(</span><span class="n">parsedLines</span><span class="p">):</span>
    <span class="n">symbolTable</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;R0&quot;</span><span class="p">:</span> <span class="s2">&quot;0000000000000000&quot;</span><span class="p">,</span>
        <span class="s2">&quot;R1&quot;</span><span class="p">:</span> <span class="s2">&quot;0000000000000001&quot;</span><span class="p">,</span>
        <span class="s2">&quot;R2&quot;</span><span class="p">:</span> <span class="s2">&quot;0000000000000010&quot;</span><span class="p">,</span>
        <span class="s2">&quot;R3&quot;</span><span class="p">:</span> <span class="s2">&quot;0000000000000011&quot;</span><span class="p">,</span>
        <span class="s2">&quot;R4&quot;</span><span class="p">:</span> <span class="s2">&quot;0000000000000100&quot;</span><span class="p">,</span>
        <span class="s2">&quot;R5&quot;</span><span class="p">:</span> <span class="s2">&quot;0000000000000101&quot;</span><span class="p">,</span>
        <span class="s2">&quot;R6&quot;</span><span class="p">:</span> <span class="s2">&quot;0000000000000110&quot;</span><span class="p">,</span>
        <span class="s2">&quot;R7&quot;</span><span class="p">:</span> <span class="s2">&quot;0000000000000111&quot;</span><span class="p">,</span>
        <span class="s2">&quot;R8&quot;</span><span class="p">:</span> <span class="s2">&quot;0000000000001000&quot;</span><span class="p">,</span>
        <span class="s2">&quot;R9&quot;</span><span class="p">:</span> <span class="s2">&quot;0000000000001001&quot;</span><span class="p">,</span>
        <span class="s2">&quot;R10&quot;</span><span class="p">:</span> <span class="s2">&quot;0000000000001010&quot;</span><span class="p">,</span>
        <span class="s2">&quot;R11&quot;</span><span class="p">:</span> <span class="s2">&quot;0000000000001011&quot;</span><span class="p">,</span>
        <span class="s2">&quot;R12&quot;</span><span class="p">:</span> <span class="s2">&quot;0000000000001100&quot;</span><span class="p">,</span>
        <span class="s2">&quot;R13&quot;</span><span class="p">:</span> <span class="s2">&quot;0000000000001101&quot;</span><span class="p">,</span>
        <span class="s2">&quot;R14&quot;</span><span class="p">:</span> <span class="s2">&quot;0000000000001110&quot;</span><span class="p">,</span>
        <span class="s2">&quot;R15&quot;</span><span class="p">:</span> <span class="s2">&quot;0000000000001111&quot;</span><span class="p">,</span>
        <span class="s2">&quot;SP&quot;</span><span class="p">:</span> <span class="s2">&quot;0000000000000000&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ARG&quot;</span><span class="p">:</span> <span class="s2">&quot;0000000000000010&quot;</span><span class="p">,</span>
        <span class="s2">&quot;LCL&quot;</span><span class="p">:</span> <span class="s2">&quot;0000000000000001&quot;</span><span class="p">,</span>
        <span class="s2">&quot;THIS&quot;</span><span class="p">:</span> <span class="s2">&quot;0000000000000011&quot;</span><span class="p">,</span>
        <span class="s2">&quot;THAT&quot;</span><span class="p">:</span> <span class="s2">&quot;0000000000000100&quot;</span><span class="p">,</span>
        <span class="s2">&quot;KBD&quot;</span><span class="p">:</span> <span class="s2">&quot;0110000000000000&quot;</span><span class="p">,</span>
        <span class="s2">&quot;SCREEN&quot;</span><span class="p">:</span> <span class="s2">&quot;0100000000000000&quot;</span>
    <span class="p">}</span>
    <span class="n">A_Instruction</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;@&#39;</span><span class="p">)</span>
    <span class="n">C_Instruction</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s2">&quot;=&quot;</span> <span class="ow">in</span> <span class="n">x</span> <span class="ow">or</span> <span class="s2">&quot;;&quot;</span> <span class="ow">in</span> <span class="n">x</span>
    <span class="n">L_Instruction</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;(&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">x</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;)&quot;</span><span class="p">)</span>
    <span class="n">L_Value</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;(&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;)&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

    <span class="n">lineNum</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">parsedLines</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">A_Instruction</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="ow">or</span> <span class="n">C_Instruction</span><span class="p">(</span><span class="n">line</span><span class="p">):</span>
            <span class="n">lineNum</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="n">L_Instruction</span><span class="p">(</span><span class="n">line</span><span class="p">):</span>
            <span class="n">binaryLineNum</span> <span class="o">=</span> <span class="nb">bin</span><span class="p">(</span><span class="n">lineNum</span><span class="p">)[</span><span class="mi">2</span><span class="p">:]</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>
            <span class="n">symbolTable</span><span class="p">[</span><span class="n">L_Value</span><span class="p">(</span><span class="n">line</span><span class="p">)]</span> <span class="o">=</span> <span class="n">binaryLineNum</span>

    <span class="n">baseAddress</span> <span class="o">=</span> <span class="mi">16</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">parsedLines</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">A_Instruction</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
            <span class="k">if</span> <span class="n">value</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">symbolTable</span><span class="p">:</span>
                <span class="n">valueBinary</span> <span class="o">=</span> <span class="nb">bin</span><span class="p">(</span><span class="n">lineNum</span><span class="p">)[</span><span class="mi">2</span><span class="p">:]</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>
                <span class="n">symbolTable</span><span class="p">[</span><span class="n">value</span><span class="p">]</span> <span class="o">=</span> <span class="n">valueBinary</span>
                <span class="n">baseAddress</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">return</span> <span class="n">symbolTable</span>


<span class="k">def</span> <span class="nf">Code</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">symbolTable</span><span class="p">):</span>
    <span class="n">COMPUTATIONS</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;0&quot;</span><span class="p">:</span> <span class="s2">&quot;0101010&quot;</span><span class="p">,</span>
        <span class="s2">&quot;1&quot;</span><span class="p">:</span> <span class="s2">&quot;0111111&quot;</span><span class="p">,</span>
        <span class="s2">&quot;-1&quot;</span><span class="p">:</span> <span class="s2">&quot;0111010&quot;</span><span class="p">,</span>
        <span class="s2">&quot;D&quot;</span><span class="p">:</span> <span class="s2">&quot;0001100&quot;</span><span class="p">,</span>
        <span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="s2">&quot;0110000&quot;</span><span class="p">,</span>
        <span class="s2">&quot;!D&quot;</span><span class="p">:</span> <span class="s2">&quot;0001101&quot;</span><span class="p">,</span>
        <span class="s2">&quot;!A&quot;</span><span class="p">:</span> <span class="s2">&quot;0110001&quot;</span><span class="p">,</span>
        <span class="s2">&quot;-D&quot;</span><span class="p">:</span> <span class="s2">&quot;0001111&quot;</span><span class="p">,</span>
        <span class="s2">&quot;-A&quot;</span><span class="p">:</span> <span class="s2">&quot;0110011&quot;</span><span class="p">,</span>
        <span class="s2">&quot;D+1&quot;</span><span class="p">:</span> <span class="s2">&quot;0011111&quot;</span><span class="p">,</span>
        <span class="s2">&quot;A+1&quot;</span><span class="p">:</span> <span class="s2">&quot;0110111&quot;</span><span class="p">,</span>
        <span class="s2">&quot;D-1&quot;</span><span class="p">:</span> <span class="s2">&quot;0001110&quot;</span><span class="p">,</span>
        <span class="s2">&quot;A-1&quot;</span><span class="p">:</span> <span class="s2">&quot;0110010&quot;</span><span class="p">,</span>
        <span class="s2">&quot;D+A&quot;</span><span class="p">:</span> <span class="s2">&quot;0000010&quot;</span><span class="p">,</span>
        <span class="s2">&quot;D-A&quot;</span><span class="p">:</span> <span class="s2">&quot;0010011&quot;</span><span class="p">,</span>
        <span class="s2">&quot;A-D&quot;</span><span class="p">:</span> <span class="s2">&quot;0000111&quot;</span><span class="p">,</span>
        <span class="s2">&quot;D&amp;A&quot;</span><span class="p">:</span> <span class="s2">&quot;0000000&quot;</span><span class="p">,</span>
        <span class="s2">&quot;D|A&quot;</span><span class="p">:</span> <span class="s2">&quot;0010101&quot;</span><span class="p">,</span>
        <span class="s2">&quot;M&quot;</span><span class="p">:</span> <span class="s2">&quot;1110000&quot;</span><span class="p">,</span>
        <span class="s2">&quot;!M&quot;</span><span class="p">:</span> <span class="s2">&quot;1110001&quot;</span><span class="p">,</span>
        <span class="s2">&quot;-M&quot;</span><span class="p">:</span> <span class="s2">&quot;1110011&quot;</span><span class="p">,</span>
        <span class="s2">&quot;M+1&quot;</span><span class="p">:</span> <span class="s2">&quot;1110111&quot;</span><span class="p">,</span>
        <span class="s2">&quot;M-1&quot;</span><span class="p">:</span> <span class="s2">&quot;1110010&quot;</span><span class="p">,</span>
        <span class="s2">&quot;D+M&quot;</span><span class="p">:</span> <span class="s2">&quot;1000010&quot;</span><span class="p">,</span>
        <span class="s2">&quot;D-M&quot;</span><span class="p">:</span> <span class="s2">&quot;1010011&quot;</span><span class="p">,</span>
        <span class="s2">&quot;M-D&quot;</span><span class="p">:</span> <span class="s2">&quot;1000111&quot;</span><span class="p">,</span>
        <span class="s2">&quot;D&amp;M&quot;</span><span class="p">:</span> <span class="s2">&quot;1000000&quot;</span><span class="p">,</span>
        <span class="s2">&quot;D|M&quot;</span><span class="p">:</span> <span class="s2">&quot;1010101&quot;</span>
    <span class="p">}</span>
    <span class="n">DESTINATIONS</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;&quot;</span><span class="p">:</span> <span class="s2">&quot;000&quot;</span><span class="p">,</span>
        <span class="s2">&quot;M&quot;</span><span class="p">:</span> <span class="s2">&quot;001&quot;</span><span class="p">,</span>
        <span class="s2">&quot;D&quot;</span><span class="p">:</span> <span class="s2">&quot;010&quot;</span><span class="p">,</span>
        <span class="s2">&quot;MD&quot;</span><span class="p">:</span> <span class="s2">&quot;011&quot;</span><span class="p">,</span>
        <span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="s2">&quot;100&quot;</span><span class="p">,</span>
        <span class="s2">&quot;AM&quot;</span><span class="p">:</span> <span class="s2">&quot;101&quot;</span><span class="p">,</span>
        <span class="s2">&quot;AD&quot;</span><span class="p">:</span> <span class="s2">&quot;110&quot;</span><span class="p">,</span>
        <span class="s2">&quot;AMD&quot;</span><span class="p">:</span> <span class="s2">&quot;111&quot;</span>
    <span class="p">}</span>
    <span class="n">JUMPS</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;&quot;</span><span class="p">:</span> <span class="s2">&quot;000&quot;</span><span class="p">,</span>
        <span class="s2">&quot;JGT&quot;</span><span class="p">:</span> <span class="s2">&quot;001&quot;</span><span class="p">,</span>
        <span class="s2">&quot;JEQ&quot;</span><span class="p">:</span> <span class="s2">&quot;010&quot;</span><span class="p">,</span>
        <span class="s2">&quot;JGE&quot;</span><span class="p">:</span> <span class="s2">&quot;011&quot;</span><span class="p">,</span>
        <span class="s2">&quot;JLT&quot;</span><span class="p">:</span> <span class="s2">&quot;100&quot;</span><span class="p">,</span>
        <span class="s2">&quot;JNE&quot;</span><span class="p">:</span> <span class="s2">&quot;101&quot;</span><span class="p">,</span>
        <span class="s2">&quot;JLE&quot;</span><span class="p">:</span> <span class="s2">&quot;110&quot;</span><span class="p">,</span>
        <span class="s2">&quot;JMP&quot;</span><span class="p">:</span> <span class="s2">&quot;111&quot;</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;(&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">line</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;)&quot;</span><span class="p">):</span>
        <span class="k">return</span>
    <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;@&quot;</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">symbolTable</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">symbolTable</span><span class="p">[</span><span class="n">value</span><span class="p">]</span>
        <span class="n">valueBinary</span> <span class="o">=</span> <span class="nb">bin</span><span class="p">(</span><span class="n">value</span><span class="p">)[</span><span class="mi">2</span><span class="p">:]</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">valueBinary</span>

    <span class="n">dest</span><span class="p">,</span> <span class="n">jump</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span>
    <span class="n">comp</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># dest=comp;jump</span>
    <span class="k">if</span> <span class="s2">&quot;=&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span> 
        <span class="n">dest</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="s2">&quot;;&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span> 
        <span class="n">jump</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
    <span class="n">compBinary</span> <span class="o">=</span> <span class="n">COMPUTATIONS</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">comp</span><span class="p">,</span> <span class="s1">&#39;0000000&#39;</span><span class="p">)</span>
    <span class="n">destBinary</span> <span class="o">=</span> <span class="n">DESTINATIONS</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">dest</span><span class="p">,</span> <span class="s1">&#39;000&#39;</span><span class="p">)</span>
    <span class="n">jumpBinary</span> <span class="o">=</span> <span class="n">JUMPS</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">jump</span><span class="p">,</span> <span class="s1">&#39;000&#39;</span><span class="p">)</span>
    <span class="n">combinedBinaryCode</span> <span class="o">=</span> <span class="s1">&#39;111&#39;</span> <span class="o">+</span> <span class="n">compBinary</span> <span class="o">+</span> <span class="n">destBinary</span> <span class="o">+</span> <span class="n">jumpBinary</span>
    <span class="k">return</span> <span class="n">combinedBinaryCode</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">parsedLines</span> <span class="o">=</span> <span class="n">Parser</span><span class="p">(</span><span class="s2">&quot;Max.asm&quot;</span><span class="p">)</span>
    <span class="n">buildSymbolTable</span> <span class="o">=</span> <span class="n">symbolTable</span><span class="p">(</span><span class="n">parsedLines</span><span class="p">)</span>
    <span class="n">generatedBinaryCode</span> <span class="o">=</span> <span class="p">[</span><span class="n">Code</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">buildSymbolTable</span><span class="p">)</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">parsedLines</span><span class="p">]</span>
    <span class="n">hackLines</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">line</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">generatedBinaryCode</span> <span class="k">if</span> <span class="n">line</span><span class="p">])</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;Max.hack&#39;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">hackLines</span><span class="p">)</span>
</code></pre></div>

  <hr>
<div class="md-source-file">
  <small>
    
      Last update:
      <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">July 11, 2022</span>
      
    
  </small>
</div>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../sys-index/" class="md-footer__link md-footer__link--prev" aria-label="Previous: 目录" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              目录
            </div>
          </div>
        </a>
      
      
        
        <a href="../nand2tetris_part_2/" class="md-footer__link md-footer__link--next" aria-label="Next: Nand2Tetris Part2 (Software)" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Nand2Tetris Part2 (Software)
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      &copy; 2022 by Xiaoyu Chu
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs", "navigation.tabs.sticky"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../assets/javascripts/workers/search.0bbba5b5.min.js"}</script>
    
    
      <script src="../assets/javascripts/bundle.649a939e.min.js"></script>
      
        <script src="../js/extra.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
    
  </body>
</html>