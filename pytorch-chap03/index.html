
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../image/logo.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-8.1.2">
    
    
      
        <title>Chapter03 PyTorchçš„ä¸»è¦ç»„æˆæ¨¡å— - Xiaoyu's Blog</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.f7951f6f.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.e6a45f82.min.css">
        
          
          
          <meta name="theme-color" content="#000000">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Serif+Pro:300,400,400i,700%7C&display=fallback">
        <style>:root{--md-text-font:"Source Serif Pro";--md-code-font:""}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="black" data-md-color-accent="">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#pytorch" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Xiaoyu&#39;s Blog" class="md-header__button md-logo" aria-label="Xiaoyu's Blog" data-md-component="logo">
      
  <img src="../image/logo2.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Xiaoyu's Blog
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Chapter03 PyTorchçš„ä¸»è¦ç»„æˆæ¨¡å—
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href=".." class="md-tabs__link">
      ğŸ  Home
    </a>
  </li>

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../ml-index/" class="md-tabs__link md-tabs__link--active">
        ğŸ¤– Machine Learning
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../sys-index/" class="md-tabs__link">
        ğŸ’¾ Computer Systems
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../post-types-of-paper/" class="md-tabs__link">
        ğŸ“ Posts
      </a>
    </li>
  

      
        
  
  


  <li class="md-tabs__item">
    <a href="https://www.chuxiaoyu.cn/" class="md-tabs__link">
      ğŸ§‘â€ğŸš€ About
    </a>
  </li>

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Xiaoyu&#39;s Blog" class="md-nav__button md-logo" aria-label="Xiaoyu's Blog" data-md-component="logo">
      
  <img src="../image/logo2.png" alt="logo">

    </a>
    Xiaoyu's Blog
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        ğŸ  Home
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          ğŸ¤– Machine Learning
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="ğŸ¤– Machine Learning" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          ğŸ¤– Machine Learning
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ml-index/" class="md-nav__link">
        ç›®å½•
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_2" type="checkbox" id="__nav_2_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2_2">
          CS224nè‡ªç„¶è¯­è¨€å¤„ç†
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="CS224nè‡ªç„¶è¯­è¨€å¤„ç†" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_2">
          <span class="md-nav__icon md-icon"></span>
          CS224nè‡ªç„¶è¯­è¨€å¤„ç†
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Lecture07/" class="md-nav__link">
        Lecture07 æœºå™¨ç¿»è¯‘ã€seq2seqæ¨¡å‹ã€æ³¨æ„åŠ›æœºåˆ¶
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Lecture09/" class="md-nav__link">
        Lecture09 è‡ªæ³¨æ„åŠ›æ¨¡å‹ã€Transformers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Lecture10/" class="md-nav__link">
        Lecture10 é¢„è®­ç»ƒ
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Lecture11/" class="md-nav__link">
        Lecture11 é—®ç­”ç³»ç»Ÿ
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_3" type="checkbox" id="__nav_2_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2_3">
          åŸºäºtransformersçš„NLP
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="åŸºäºtransformersçš„NLP" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_3">
          <span class="md-nav__icon md-icon"></span>
          åŸºäºtransformersçš„NLP
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../nlp-transformer-task01/" class="md-nav__link">
        Task01 NLPå­¦ä¹ æ¦‚è§ˆ
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../nlp-transformer-task02/" class="md-nav__link">
        Task02 å­¦ä¹ Attentioinå’ŒTransformer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../nlp-transformer-task03/" class="md-nav__link">
        Task03 å­¦ä¹ BERT
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../nlp-transformer-task04/" class="md-nav__link">
        Task04 å­¦ä¹ GPT
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../nlp-transformer-task05/" class="md-nav__link">
        Task05 ç¼–å†™BERTæ¨¡å‹
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../nlp-transformer-task06/" class="md-nav__link">
        Task06 BERTåº”ç”¨ã€è®­ç»ƒå’Œä¼˜åŒ–
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../nlp-transformer-task07/" class="md-nav__link">
        Task07 ä½¿ç”¨Transformersè§£å†³æ–‡æœ¬åˆ†ç±»ä»»åŠ¡
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_4" type="checkbox" id="__nav_2_4" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_2_4">
          æ·±å…¥æµ…å‡ºPyTorch
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="æ·±å…¥æµ…å‡ºPyTorch" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_4">
          <span class="md-nav__icon md-icon"></span>
          æ·±å…¥æµ…å‡ºPyTorch
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../pytorch-chap01-02/" class="md-nav__link">
        Chapter01-02 PyTorchçš„ç®€ä»‹å’Œå®‰è£…ã€PyTorchåŸºç¡€çŸ¥è¯†
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Chapter03 PyTorchçš„ä¸»è¦ç»„æˆæ¨¡å—
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Chapter03 PyTorchçš„ä¸»è¦ç»„æˆæ¨¡å—
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    å®Œæˆæ·±åº¦å­¦ä¹ çš„å¿…è¦éƒ¨åˆ†
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    åŸºæœ¬é…ç½®
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    æ•°æ®åŠ è½½å’Œå¤„ç†
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    æ¨¡å‹æ„å»º
  </a>
  
    <nav class="md-nav" aria-label="æ¨¡å‹æ„å»º">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    ç¥ç»ç½‘ç»œçš„æ„é€ 
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    ç¥ç»ç½‘ç»œä¸­å¸¸è§çš„å±‚
  </a>
  
    <nav class="md-nav" aria-label="ç¥ç»ç½‘ç»œä¸­å¸¸è§çš„å±‚">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    ä¸å«æ¨¡å‹å‚æ•°çš„å±‚
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    å«æ¨¡å‹å‚æ•°çš„å±‚
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    äºŒç»´å·ç§¯å±‚
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    æ± åŒ–å±‚
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lenet" class="md-nav__link">
    æ¨¡å‹ç¤ºä¾‹ï¼šLeNet
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#alexnet" class="md-nav__link">
    æ¨¡å‹ç¤ºä¾‹ï¼šAlexNet
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    æŸå¤±å‡½æ•°
  </a>
  
    <nav class="md-nav" aria-label="æŸå¤±å‡½æ•°">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    äºŒåˆ†ç±»äº¤å‰ç†µæŸå¤±å‡½æ•°
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    å…¶ä»–æŸå¤±å‡½æ•°
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    ä¼˜åŒ–å™¨
  </a>
  
    <nav class="md-nav" aria-label="ä¼˜åŒ–å™¨">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    ä»€ä¹ˆæ˜¯ä¼˜åŒ–å™¨
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_1" class="md-nav__link">
    PyTorchæä¾›çš„ä¼˜åŒ–å™¨
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_16" class="md-nav__link">
    è®­ç»ƒä¸è¯„ä¼°
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_17" class="md-nav__link">
    å¯è§†åŒ–
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_18" class="md-nav__link">
    å‚è€ƒèµ„æ–™
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../pytorch-chap04/" class="md-nav__link">
        Chapter04 PyTorchåŸºç¡€å®æˆ˜â€”â€”FashionMNISTå›¾åƒåˆ†ç±»
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          ğŸ’¾ Computer Systems
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="ğŸ’¾ Computer Systems" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          ğŸ’¾ Computer Systems
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sys-index/" class="md-nav__link">
        ç›®å½•
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_2" type="checkbox" id="__nav_3_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_2">
          Nand2Tetris è®¡ç®—æœºç³»ç»Ÿè¦ç´ 
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Nand2Tetris è®¡ç®—æœºç³»ç»Ÿè¦ç´ " data-md-level="2">
        <label class="md-nav__title" for="__nav_3_2">
          <span class="md-nav__icon md-icon"></span>
          Nand2Tetris è®¡ç®—æœºç³»ç»Ÿè¦ç´ 
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../nand2tetris_part_1/" class="md-nav__link">
        Nand2Tetris Part1 (Hardware)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../nand2tetris_part_2/" class="md-nav__link">
        Nand2Tetris Part2 (Software)
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_3" type="checkbox" id="__nav_3_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_3">
          ML Compilation æœºå™¨å­¦ä¹ ç¼–è¯‘
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="ML Compilation æœºå™¨å­¦ä¹ ç¼–è¯‘" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_3">
          <span class="md-nav__icon md-icon"></span>
          ML Compilation æœºå™¨å­¦ä¹ ç¼–è¯‘
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ml-compilation-01/" class="md-nav__link">
        01 æœºå™¨å­¦ä¹ ç¼–è¯‘æ¦‚è¿°
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ml-compilation-02/" class="md-nav__link">
        02 å¼ é‡ç¨‹åºæŠ½è±¡
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ml-compilation-03/" class="md-nav__link">
        03 å¼ é‡ç¨‹åºæŠ½è±¡æ¡ˆä¾‹ç ”ç©¶ï¼šTensorIR
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ml-compilation-04/" class="md-nav__link">
        04 ç«¯åˆ°ç«¯æ¨¡å‹æ•´åˆ
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          ğŸ“ Posts
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="ğŸ“ Posts" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          ğŸ“ Posts
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../post-types-of-paper/" class="md-nav__link">
        Types of CS Paper
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../open-source-projects/" class="md-nav__link">
        Open Source Projects
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="https://www.chuxiaoyu.cn/" class="md-nav__link">
        ğŸ§‘â€ğŸš€ About
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    å®Œæˆæ·±åº¦å­¦ä¹ çš„å¿…è¦éƒ¨åˆ†
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    åŸºæœ¬é…ç½®
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    æ•°æ®åŠ è½½å’Œå¤„ç†
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    æ¨¡å‹æ„å»º
  </a>
  
    <nav class="md-nav" aria-label="æ¨¡å‹æ„å»º">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    ç¥ç»ç½‘ç»œçš„æ„é€ 
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    ç¥ç»ç½‘ç»œä¸­å¸¸è§çš„å±‚
  </a>
  
    <nav class="md-nav" aria-label="ç¥ç»ç½‘ç»œä¸­å¸¸è§çš„å±‚">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    ä¸å«æ¨¡å‹å‚æ•°çš„å±‚
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    å«æ¨¡å‹å‚æ•°çš„å±‚
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    äºŒç»´å·ç§¯å±‚
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    æ± åŒ–å±‚
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lenet" class="md-nav__link">
    æ¨¡å‹ç¤ºä¾‹ï¼šLeNet
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#alexnet" class="md-nav__link">
    æ¨¡å‹ç¤ºä¾‹ï¼šAlexNet
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    æŸå¤±å‡½æ•°
  </a>
  
    <nav class="md-nav" aria-label="æŸå¤±å‡½æ•°">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    äºŒåˆ†ç±»äº¤å‰ç†µæŸå¤±å‡½æ•°
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    å…¶ä»–æŸå¤±å‡½æ•°
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    ä¼˜åŒ–å™¨
  </a>
  
    <nav class="md-nav" aria-label="ä¼˜åŒ–å™¨">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    ä»€ä¹ˆæ˜¯ä¼˜åŒ–å™¨
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch_1" class="md-nav__link">
    PyTorchæä¾›çš„ä¼˜åŒ–å™¨
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_16" class="md-nav__link">
    è®­ç»ƒä¸è¯„ä¼°
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_17" class="md-nav__link">
    å¯è§†åŒ–
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_18" class="md-nav__link">
    å‚è€ƒèµ„æ–™
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                

<h1 id="pytorch">ç¬¬ä¸‰ç«  PyTorchçš„ä¸»è¦ç»„æˆæ¨¡å—<a class="headerlink" href="#pytorch" title="Permanent link">&para;</a></h1>
<h2 id="_1">å®Œæˆæ·±åº¦å­¦ä¹ çš„å¿…è¦éƒ¨åˆ†<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<p>æœºå™¨å­¦ä¹ ï¼š</p>
<ol>
<li>æ•°æ®é¢„å¤„ç†ï¼ˆæ•°æ®æ ¼å¼ã€æ•°æ®è½¬æ¢ã€åˆ’åˆ†æ•°æ®é›†ï¼‰</li>
<li>é€‰æ‹©æ¨¡å‹ï¼Œè®¾å®šæŸå¤±å’Œä¼˜åŒ–å‡½æ•°ï¼Œè®¾ç½®è¶…å‚æ•°</li>
<li>è®­ç»ƒæ¨¡å‹ï¼Œæ‹Ÿåˆè®­ç»ƒé›†</li>
<li>è¯„ä¼°æ¨¡å‹ï¼Œåœ¨å¹¶åœ¨éªŒè¯é›†/æµ‹è¯•é›†ä¸Šè®¡ç®—æ¨¡å‹è¡¨ç°</li>
</ol>
<p>æ·±åº¦å­¦ä¹ çš„æ³¨æ„äº‹é¡¹ï¼š</p>
<ol>
<li>æ•°æ®é¢„å¤„ç†ï¼ˆæ•°æ®åŠ è½½ã€æ‰¹å¤„ç†ï¼‰</li>
<li>é€å±‚æ­å»ºæ¨¡å‹ï¼Œç»„è£…ä¸åŒæ¨¡å—</li>
<li>GPUçš„é…ç½®å’Œæ“ä½œ</li>
</ol>
<p><img src="https://github.com/chuxiaoyu/blog_image/blob/master/pytorch/11_dnn.jpg?raw=true" width="600" alt="" align="center" /></p>
<h2 id="_2">åŸºæœ¬é…ç½®<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h2>
<p>å¯¼å…¥å¿…é¡»çš„åŒ…ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">torch.nn</span> <span class="k">as</span> <span class="nn">nn</span>
<span class="kn">from</span> <span class="nn">torch.utils.data</span> <span class="kn">import</span> <span class="n">Dataset</span><span class="p">,</span> <span class="n">DataLoader</span>
<span class="kn">import</span> <span class="nn">torch.optim</span> <span class="k">as</span> <span class="nn">optimizer</span>
</code></pre></div>
<p>è¶…å‚æ•°è®¾ç½®ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="n">batch_size</span> <span class="o">=</span> <span class="mi">16</span>  <span class="c1"># batch size</span>
<span class="n">lr</span> <span class="o">=</span> <span class="mf">1e-4</span>  <span class="c1"># åˆå§‹å­¦ä¹ ç‡</span>
<span class="n">max_epochs</span> <span class="o">=</span> <span class="mi">100</span>  <span class="c1"># è®­ç»ƒæ¬¡æ•° </span>
</code></pre></div>
<p>GPUçš„è®¾ç½®ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="c1"># æ–¹æ¡ˆä¸€ï¼šä½¿ç”¨os.environï¼Œè¿™ç§æƒ…å†µå¦‚æœä½¿ç”¨GPUä¸éœ€è¦è®¾ç½®</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;CUDA_VISIBLE_DEVICES&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;0,1&#39;</span>

<span class="c1"># æ–¹æ¡ˆäºŒï¼šä½¿ç”¨â€œdeviceâ€ï¼Œåç»­å¯¹è¦ä½¿ç”¨GPUçš„å˜é‡ç”¨.to(device)å³å¯</span>
<span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s2">&quot;cuda:1&quot;</span> <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">()</span> <span class="k">else</span> <span class="s2">&quot;cpu&quot;</span><span class="p">)</span>
</code></pre></div>
<h2 id="_3">æ•°æ®åŠ è½½å’Œå¤„ç†<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h2>
<p>PyTorchæ•°æ®è¯»å…¥æ˜¯é€šè¿‡Dataset+Dataloaderçš„æ–¹å¼å®Œæˆçš„ï¼ŒDatasetå®šä¹‰å¥½æ•°æ®çš„æ ¼å¼å’Œæ•°æ®å˜æ¢å½¢å¼ï¼ŒDataloaderç”¨iterativeçš„æ–¹å¼ä¸æ–­è¯»å…¥æ‰¹æ¬¡æ•°æ®ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥å®šä¹‰è‡ªå·±çš„Datasetç±»æ¥å®ç°çµæ´»çš„æ•°æ®è¯»å–ï¼Œå®šä¹‰çš„ç±»éœ€è¦ç»§æ‰¿PyTorchè‡ªèº«çš„Datasetç±»ã€‚ä¸»è¦åŒ…å«ä¸‰ä¸ªå‡½æ•°ï¼š</p>
<ul>
<li><code>__init__</code>: ç”¨äºå‘ç±»ä¸­ä¼ å…¥å¤–éƒ¨å‚æ•°ï¼ŒåŒæ—¶å®šä¹‰æ ·æœ¬é›†</li>
<li><code>__getitem__</code>: ç”¨äºé€ä¸ªè¯»å–æ ·æœ¬é›†åˆä¸­çš„å…ƒç´ ï¼Œå¯ä»¥è¿›è¡Œä¸€å®šçš„å˜æ¢ï¼Œå¹¶å°†è¿”å›è®­ç»ƒ/éªŒè¯æ‰€éœ€çš„æ•°æ®</li>
<li><code>__len__</code>: ç”¨äºè¿”å›æ•°æ®é›†çš„æ ·æœ¬æ•°</li>
</ul>
<p><img src="https://github.com/chuxiaoyu/blog_image/blob/master/pytorch/12_dataset.jpg?raw=true" width="600" alt="" align="center" /></p>
<ul>
<li>batch_sizeï¼šæ ·æœ¬æ˜¯æŒ‰â€œæ‰¹â€è¯»å…¥çš„ï¼Œbatch_sizeå°±æ˜¯æ¯æ¬¡è¯»å…¥çš„æ ·æœ¬æ•°</li>
<li>num_workersï¼šæœ‰å¤šå°‘ä¸ªè¿›ç¨‹ç”¨äºè¯»å–æ•°æ®</li>
<li>shuffleï¼šæ˜¯å¦å°†è¯»å…¥çš„æ•°æ®æ‰“ä¹±</li>
<li>drop_lastï¼šå¯¹äºæ ·æœ¬æœ€åä¸€éƒ¨åˆ†æ²¡æœ‰è¾¾åˆ°æ‰¹æ¬¡æ•°çš„æ ·æœ¬ï¼Œä¸å†å‚ä¸è®­ç»ƒ</li>
</ul>
<p>ä¸‹é¢æ˜¯æœ¬éƒ¨åˆ†ä»£ç åœ¨notebookä¸­çš„è¿è¡Œæƒ…å†µã€‚ä¸»è¦å‚è€ƒ PyTorchå®˜æ–¹æ•™ç¨‹ä¸­æ–‡ç‰ˆ <a href="https://pytorch123.com/SecondSection/training_a_classifier/">https://pytorch123.com/SecondSection/training_a_classifier/</a></p>
<p><img src="https://github.com/chuxiaoyu/blog_image/blob/master/pytorch/chap03.jpg?raw=true" width="" alt="" align="center" /></p>
<h2 id="_4">æ¨¡å‹æ„å»º<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h2>
<h3 id="_5">ç¥ç»ç½‘ç»œçš„æ„é€ <a class="headerlink" href="#_5" title="Permanent link">&para;</a></h3>
<p>PyTorchä¸­ç¥ç»ç½‘ç»œæ„é€ ä¸€èˆ¬æ˜¯åŸºäº Module ç±»çš„æ¨¡å‹æ¥å®Œæˆçš„ã€‚Module ç±»æ˜¯ nn æ¨¡å—ï§©æä¾›çš„ä¸€ä¸ªæ¨¡å‹æ„é€ ç±»ï¼Œæ˜¯æ‰€æœ‰ç¥ç»â½¹ç½‘ç»œæ¨¡å—çš„åŸºç±»ï¼Œæˆ‘ä»¬å¯ä»¥ç»§æ‰¿å®ƒæ¥å®šä¹‰æˆ‘ä»¬æƒ³è¦çš„æ¨¡å‹ã€‚ä¸‹é¢ç»§æ‰¿ Module ç±»æ„é€ å¤šå±‚æ„ŸçŸ¥æœºï¼ˆMLPï¼‰ã€‚</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">from</span> <span class="nn">torch</span> <span class="kn">import</span> <span class="n">nn</span>

<span class="k">class</span> <span class="nc">MLP</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
  <span class="c1"># å£°æ˜å¸¦æœ‰æ¨¡å‹å‚æ•°çš„å±‚ï¼Œè¿™é‡Œå£°æ˜äº†ä¸¤ä¸ªå…¨è¿æ¥å±‚</span>
  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="c1"># è°ƒç”¨MLPçˆ¶ç±»Blockçš„æ„é€ å‡½æ•°æ¥è¿›è¡Œå¿…è¦çš„åˆå§‹åŒ–ã€‚è¿™æ ·åœ¨æ„é€ å®ä¾‹ä¾‹æ—¶è¿˜å¯ä»¥æŒ‡å®šå…¶ä»–å‡½æ•°</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">MLP</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">hidden</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">784</span><span class="p">,</span> <span class="mi">256</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">act</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">output</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">256</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>

   <span class="c1"># å®šä¹‰æ¨¡å‹çš„å‰å‘è®¡ç®—ï¼Œå³å¦‚ä½•æ ¹æ®è¾“å…¥xè®¡ç®—è¿”å›æ‰€éœ€è¦çš„æ¨¡å‹è¾“å‡º</span>
  <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="n">o</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">act</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hidden</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="n">o</span><span class="p">)</span>
</code></pre></div>
<p>æˆ‘ä»¬å¯ä»¥å®ä¾‹åŒ– MLP ç±»å¾—åˆ°æ¨¡å‹å˜ï¥¾ net ã€‚ä¸‹â¾¯çš„ä»£ç åˆå§‹åŒ– net å¹¶ä¼ å…¥è¾“â¼Šæ•°æ® X åšä¸€æ¬¡å‰å‘è®¡ç®—ã€‚å…¶ä¸­ï¼Œ net(X) ä¼šè°ƒç”¨ MLP ç»§æ‰¿â¾ƒè‡ª Module ç±»çš„ <strong>call</strong> å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°å°†è°ƒâ½¤ç”¨ MLP ç±»å®šä¹‰çš„forward å‡½æ•°æ¥å®Œæˆå‰å‘è®¡ç®—ã€‚</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">torch</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">X</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">784</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">X</span>
<span class="n">tensor</span><span class="p">([[</span><span class="mf">0.3277</span><span class="p">,</span> <span class="mf">0.2204</span><span class="p">,</span> <span class="mf">0.5239</span><span class="p">,</span>  <span class="o">...</span><span class="p">,</span> <span class="mf">0.4333</span><span class="p">,</span> <span class="mf">0.1906</span><span class="p">,</span> <span class="mf">0.1318</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.9850</span><span class="p">,</span> <span class="mf">0.2121</span><span class="p">,</span> <span class="mf">0.8405</span><span class="p">,</span>  <span class="o">...</span><span class="p">,</span> <span class="mf">0.3796</span><span class="p">,</span> <span class="mf">0.2717</span><span class="p">,</span> <span class="mf">0.5553</span><span class="p">]])</span>

<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">torch</span> <span class="kn">import</span> <span class="n">nn</span>
<span class="o">&gt;&gt;&gt;</span> 
<span class="o">&gt;&gt;&gt;</span> <span class="k">class</span> <span class="nc">MLP</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<span class="o">...</span>   <span class="c1"># å£°æ˜å¸¦æœ‰æ¨¡å‹å‚æ•°çš„å±‚ï¼Œè¿™é‡Œå£°æ˜äº†ä¸¤ä¸ªå…¨è¿æ¥å±‚</span>
<span class="o">...</span>   <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="o">...</span>     <span class="c1"># è°ƒç”¨MLPçˆ¶ç±»Blockçš„æ„é€ å‡½æ•°æ¥è¿›è¡Œå¿…è¦çš„åˆå§‹åŒ–ã€‚è¿™æ ·åœ¨æ„é€ å®ä¾‹ä¾‹æ—¶è¿˜å¯ä»¥æŒ‡å®šå…¶ä»–å‡½æ•°</span>
<span class="o">...</span>     <span class="nb">super</span><span class="p">(</span><span class="n">MLP</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="o">...</span>     <span class="bp">self</span><span class="o">.</span><span class="n">hidden</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">784</span><span class="p">,</span> <span class="mi">256</span><span class="p">)</span>
<span class="o">...</span>     <span class="bp">self</span><span class="o">.</span><span class="n">act</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">()</span>
<span class="o">...</span>     <span class="bp">self</span><span class="o">.</span><span class="n">output</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">256</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="o">...</span>     
<span class="o">...</span>    <span class="c1"># å®šä¹‰æ¨¡å‹çš„å‰å‘è®¡ç®—ï¼Œå³å¦‚ä½•æ ¹æ®è¾“å…¥xè®¡ç®—è¿”å›æ‰€éœ€è¦çš„æ¨¡å‹è¾“å‡º</span>
<span class="o">...</span>   <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span class="o">...</span>     <span class="n">o</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">act</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hidden</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="o">...</span>     <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="n">o</span><span class="p">)</span>
<span class="o">...</span> 
<span class="o">&gt;&gt;&gt;</span> <span class="n">net</span> <span class="o">=</span> <span class="n">MLP</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">net</span>
<span class="n">MLP</span><span class="p">(</span>
  <span class="p">(</span><span class="n">hidden</span><span class="p">):</span> <span class="n">Linear</span><span class="p">(</span><span class="n">in_features</span><span class="o">=</span><span class="mi">784</span><span class="p">,</span> <span class="n">out_features</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
  <span class="p">(</span><span class="n">act</span><span class="p">):</span> <span class="n">ReLU</span><span class="p">()</span>
  <span class="p">(</span><span class="n">output</span><span class="p">):</span> <span class="n">Linear</span><span class="p">(</span><span class="n">in_features</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span> <span class="n">out_features</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">net</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">tensor</span><span class="p">([[</span> <span class="mf">0.1317</span><span class="p">,</span>  <span class="mf">0.0702</span><span class="p">,</span>  <span class="mf">0.1707</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0081</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2730</span><span class="p">,</span>  <span class="mf">0.2837</span><span class="p">,</span>  <span class="mf">0.0700</span><span class="p">,</span>  <span class="mf">0.1718</span><span class="p">,</span>
          <span class="mf">0.0299</span><span class="p">,</span>  <span class="mf">0.2082</span><span class="p">],</span>
        <span class="p">[</span> <span class="mf">0.1094</span><span class="p">,</span>  <span class="mf">0.0936</span><span class="p">,</span>  <span class="mf">0.2474</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0139</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1861</span><span class="p">,</span>  <span class="mf">0.1846</span><span class="p">,</span>  <span class="mf">0.1658</span><span class="p">,</span>  <span class="mf">0.2051</span><span class="p">,</span>
          <span class="mf">0.2609</span><span class="p">,</span>  <span class="mf">0.2227</span><span class="p">]],</span> <span class="n">grad_fn</span><span class="o">=&lt;</span><span class="n">AddmmBackward</span><span class="o">&gt;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> 
</code></pre></div>
<h3 id="_6">ç¥ç»ç½‘ç»œä¸­å¸¸è§çš„å±‚<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h3>
<h4 id="_7">ä¸å«æ¨¡å‹å‚æ•°çš„å±‚<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h4>
<p>ä¸‹â¾¯æ„é€ çš„ MyLayer ç±»é€šè¿‡ç»§æ‰¿ Module ç±»è‡ªå®šä¹‰ï¦ºä¸€ä¸ª**å°†è¾“å…¥å‡æ‰å‡å€¼åè¾“å‡º**çš„å±‚ã€‚è¿™ä¸ªå±‚ï§©ï¥§å«æ¨¡å‹å‚æ•°ã€‚</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">torch</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">torch</span> <span class="kn">import</span> <span class="n">nn</span>
<span class="o">&gt;&gt;&gt;</span> 
<span class="o">&gt;&gt;&gt;</span> <span class="k">class</span> <span class="nc">MyLayer</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="o">...</span>         <span class="nb">super</span><span class="p">(</span><span class="n">MyLayer</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="o">...</span>     <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span class="o">...</span>         <span class="k">return</span> <span class="n">x</span> <span class="o">-</span> <span class="n">x</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>  
<span class="o">...</span> 
<span class="o">&gt;&gt;&gt;</span> <span class="n">layer</span> <span class="o">=</span> <span class="n">MyLayer</span><span class="p">()</span>  <span class="c1"># å®ä¾‹åŒ–è¯¥å±‚</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">layer</span>
<span class="n">MyLayer</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">layer</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float</span><span class="p">))</span>
<span class="n">tensor</span><span class="p">([</span><span class="o">-</span><span class="mf">2.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span>  <span class="mf">2.</span><span class="p">])</span>
</code></pre></div>
<h4 id="_8">å«æ¨¡å‹å‚æ•°çš„å±‚<a class="headerlink" href="#_8" title="Permanent link">&para;</a></h4>
<p>æˆ‘ä»¬è¿˜å¯ä»¥è‡ªå®šä¹‰å«æ¨¡å‹å‚æ•°çš„è‡ªå®šä¹‰å±‚ã€‚å…¶ä¸­çš„æ¨¡å‹å‚æ•°å¯ä»¥é€šè¿‡è®­ç»ƒå­¦å‡ºã€‚</p>
<p>Parameter ç±»å…¶å®æ˜¯ Tensor çš„å­ç±»ï¼Œå¦‚æœä¸€ ä¸ª Tensor æ˜¯ Parameter ï¼Œé‚£ä¹ˆå®ƒä¼šâ¾ƒåŠ¨è¢«æ·»åŠ åˆ°æ¨¡å‹çš„å‚æ•°ï¦œè¡¨ï§©ã€‚æ‰€ä»¥åœ¨â¾ƒå®šä¹‰å«æ¨¡å‹å‚æ•°çš„å±‚æ—¶ï¼Œæˆ‘ä»¬åº”è¯¥å°†å‚æ•°å®šä¹‰æˆ Parameter ï¼Œé™¤äº†ç›´æ¥å®šä¹‰æˆ Parameter ç±»å¤–ï¼Œè¿˜å¯ä»¥ä½¿â½¤ ParameterList å’Œ ParameterDict åˆ†åˆ«å®šä¹‰å‚æ•°çš„ï¦œè¡¨å’Œå­—å…¸ã€‚</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">MyListDense</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">MyListDense</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">params</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">ParameterList</span><span class="p">([</span><span class="n">nn</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span>

    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">)):</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">mm</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">x</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">net</span> <span class="o">=</span> <span class="n">MyListDense</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">net</span><span class="p">)</span>
<span class="n">MyListDense</span><span class="p">(</span>
  <span class="p">(</span><span class="n">params</span><span class="p">):</span> <span class="n">ParameterList</span><span class="p">(</span>
      <span class="p">(</span><span class="mi">0</span><span class="p">):</span> <span class="n">Parameter</span> <span class="n">containing</span><span class="p">:</span> <span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">4</span><span class="n">x4</span><span class="p">]</span>
      <span class="p">(</span><span class="mi">1</span><span class="p">):</span> <span class="n">Parameter</span> <span class="n">containing</span><span class="p">:</span> <span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">4</span><span class="n">x4</span><span class="p">]</span>
      <span class="p">(</span><span class="mi">2</span><span class="p">):</span> <span class="n">Parameter</span> <span class="n">containing</span><span class="p">:</span> <span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">4</span><span class="n">x4</span><span class="p">]</span>
      <span class="p">(</span><span class="mi">3</span><span class="p">):</span> <span class="n">Parameter</span> <span class="n">containing</span><span class="p">:</span> <span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">4</span><span class="n">x1</span><span class="p">]</span>
  <span class="p">)</span>
<span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">MyDictDense</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">MyDictDense</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">params</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">ParameterDict</span><span class="p">({</span>
                <span class="s1">&#39;linear1&#39;</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)),</span>
                <span class="s1">&#39;linear2&#39;</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;linear3&#39;</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">))})</span> <span class="c1"># æ–°å¢</span>

    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">choice</span><span class="o">=</span><span class="s1">&#39;linear1&#39;</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">mm</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="n">choice</span><span class="p">])</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">net</span> <span class="o">=</span> <span class="n">MyDictDense</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">net</span><span class="p">)</span>
<span class="n">MyDictDense</span><span class="p">(</span>
  <span class="p">(</span><span class="n">params</span><span class="p">):</span> <span class="n">ParameterDict</span><span class="p">(</span>
      <span class="p">(</span><span class="n">linear1</span><span class="p">):</span> <span class="n">Parameter</span> <span class="n">containing</span><span class="p">:</span> <span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">4</span><span class="n">x4</span><span class="p">]</span>
      <span class="p">(</span><span class="n">linear2</span><span class="p">):</span> <span class="n">Parameter</span> <span class="n">containing</span><span class="p">:</span> <span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">4</span><span class="n">x1</span><span class="p">]</span>
      <span class="p">(</span><span class="n">linear3</span><span class="p">):</span> <span class="n">Parameter</span> <span class="n">containing</span><span class="p">:</span> <span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">4</span><span class="n">x2</span><span class="p">]</span>
  <span class="p">)</span>
<span class="p">)</span>
</code></pre></div>
<p>ä¸‹é¢ç»™å‡ºå¸¸è§çš„ç¥ç»ç½‘ç»œçš„ä¸€äº›å±‚ï¼Œæ¯”å¦‚å·ç§¯å±‚ã€æ± åŒ–å±‚ï¼Œä»¥åŠè¾ƒä¸ºåŸºç¡€çš„AlexNetï¼ŒLeNetç­‰ã€‚</p>
<h4 id="_9">äºŒç»´å·ç§¯å±‚<a class="headerlink" href="#_9" title="Permanent link">&para;</a></h4>
<p>äºŒç»´å·ç§¯å±‚å°†è¾“å…¥å’Œå·ç§¯æ ¸åšäº’ç›¸å…³è¿ç®—ï¼Œå¹¶åŠ ä¸Šä¸€ä¸ªæ ‡ï¥¾åå·®æ¥å¾—åˆ°è¾“å‡ºã€‚</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">from</span> <span class="nn">torch</span> <span class="kn">import</span> <span class="n">nn</span>

<span class="c1"># å·ç§¯è¿ç®—ï¼ˆäºŒç»´äº’ç›¸å…³ï¼‰</span>
<span class="k">def</span> <span class="nf">corr2d</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">K</span><span class="p">):</span> 
    <span class="n">h</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">K</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">float</span><span class="p">(),</span> <span class="n">K</span><span class="o">.</span><span class="n">float</span><span class="p">()</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">h</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">w</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
            <span class="n">Y</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">:</span> <span class="n">i</span> <span class="o">+</span> <span class="n">h</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span> <span class="n">j</span> <span class="o">+</span> <span class="n">w</span><span class="p">]</span> <span class="o">*</span> <span class="n">K</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">Y</span>

<span class="c1"># äºŒç»´å·ç§¯å±‚</span>
<span class="k">class</span> <span class="nc">Conv2D</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kernel_size</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Conv2D</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">weight</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">kernel_size</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bias</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">corr2d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">weight</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">bias</span>
</code></pre></div>
<p>å¡«å……(padding)æ˜¯æŒ‡åœ¨è¾“â¼Šå…¥â¾¼é«˜å’Œå®½çš„ä¸¤ä¾§å¡«å……å…ƒç´ (é€šå¸¸æ˜¯0å…ƒç´ )ã€‚</p>
<p>åœ¨äºŒç»´äº’ç›¸å…³è¿ç®—ä¸­ï¼Œå·ç§¯çª—å£ä»è¾“å…¥æ•°ç»„çš„æœ€å·¦ä¸Šæ–¹å¼€å§‹ï¼ŒæŒ‰ä»å·¦å¾€å³ã€ä»ä¸Šå¾€ä¸‹ çš„é¡ºåºï¼Œä¾æ¬¡åœ¨è¾“â¼Šæ•°ç»„ä¸Šæ»‘åŠ¨ã€‚æˆ‘ä»¬å°†æ¯æ¬¡æ»‘åŠ¨çš„ï¨ˆæ•°å’Œï¦œæ•°ç§°ä¸ºæ­¥å¹…(stride)ã€‚</p>
<p>ï¼ˆskipï¼‰</p>
<h4 id="_10">æ± åŒ–å±‚<a class="headerlink" href="#_10" title="Permanent link">&para;</a></h4>
<p>æ± åŒ–å±‚æ¯æ¬¡å¯¹è¾“å…¥æ•°æ®çš„ä¸€ä¸ªå›ºå®šå½¢çŠ¶çª—å£(â¼œç§°æ± åŒ–çª—å£)ä¸­çš„å…ƒç´ è®¡ç®—è¾“å‡ºã€‚ï¥§åŒäºå·ç§¯å±‚ï§©è®¡ç®—è¾“â¼Šå’Œæ ¸çš„äº’ç›¸å…³æ€§ï¼Œæ± åŒ–å±‚ç›´æ¥è®¡ç®—æ± åŒ–çª—å£å†…å…ƒç´ çš„æœ€å¤§å€¼æˆ–è€…å¹³å‡å€¼ã€‚è¯¥è¿ç®—ä¹Ÿ åˆ†åˆ«å«åšæœ€å¤§æ± åŒ–æˆ–å¹³å‡æ± åŒ–ã€‚</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">torch</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">torch</span> <span class="kn">import</span> <span class="n">nn</span>
<span class="o">&gt;&gt;&gt;</span> 
<span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">pool2d</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">pool_size</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;max&#39;</span><span class="p">):</span>
<span class="o">...</span>     <span class="n">p_h</span><span class="p">,</span> <span class="n">p_w</span> <span class="o">=</span> <span class="n">pool_size</span>
<span class="o">...</span>     <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">p_h</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">p_w</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
<span class="o">...</span>     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
<span class="o">...</span>         <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
<span class="o">...</span>             <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;max&#39;</span><span class="p">:</span>
<span class="o">...</span>                 <span class="n">Y</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">:</span> <span class="n">i</span> <span class="o">+</span> <span class="n">p_h</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span> <span class="n">j</span> <span class="o">+</span> <span class="n">p_w</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="o">...</span>             <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;avg&#39;</span><span class="p">:</span>
<span class="o">...</span>                 <span class="n">Y</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">:</span> <span class="n">i</span> <span class="o">+</span> <span class="n">p_h</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span> <span class="n">j</span> <span class="o">+</span> <span class="n">p_w</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="o">...</span>     <span class="k">return</span> <span class="n">Y</span>
<span class="o">...</span> 
<span class="o">&gt;&gt;&gt;</span> <span class="n">X</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">]])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">pool2d</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">array</span><span class="p">([[</span><span class="mf">4.</span><span class="p">,</span> <span class="mf">5.</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">7.</span><span class="p">,</span> <span class="mf">8.</span><span class="p">]])</span>
</code></pre></div>
<h4 id="lenet">æ¨¡å‹ç¤ºä¾‹ï¼šLeNet<a class="headerlink" href="#lenet" title="Permanent link">&para;</a></h4>
<p>ï¼ˆå¾…è¡¥å……ï¼‰</p>
<h4 id="alexnet">æ¨¡å‹ç¤ºä¾‹ï¼šAlexNet<a class="headerlink" href="#alexnet" title="Permanent link">&para;</a></h4>
<p>ï¼ˆå¾…è¡¥å……ï¼‰</p>
<h2 id="_11">æŸå¤±å‡½æ•°<a class="headerlink" href="#_11" title="Permanent link">&para;</a></h2>
<p>ä¸€ä¸ªå¥½çš„è®­ç»ƒç¦»ä¸å¼€ä¼˜è´¨çš„è´Ÿåé¦ˆï¼Œè¿™é‡Œçš„æŸå¤±å‡½æ•°å°±æ˜¯æ¨¡å‹çš„è´Ÿåé¦ˆã€‚</p>
<p>è¿™é‡Œå°†åˆ—å‡ºPyTorchä¸­å¸¸ç”¨çš„æŸå¤±å‡½æ•°ï¼ˆä¸€èˆ¬é€šè¿‡torch.nnè°ƒç”¨ï¼‰ï¼Œå¹¶è¯¦ç»†ä»‹ç»æ¯ä¸ªæŸå¤±å‡½æ•°çš„åŠŸèƒ½ä»‹ç»ã€æ•°å­¦å…¬å¼å’Œè°ƒç”¨ä»£ç ã€‚</p>
<h3 id="_12">äºŒåˆ†ç±»äº¤å‰ç†µæŸå¤±å‡½æ•°<a class="headerlink" href="#_12" title="Permanent link">&para;</a></h3>
<p><code>torch.nn.BCELoss(weight=None, size_average=None, reduce=None, reduction='mean')</code></p>
<p><strong>åŠŸèƒ½</strong>ï¼šè®¡ç®—äºŒåˆ†ç±»ä»»åŠ¡æ—¶çš„äº¤å‰ç†µï¼ˆCross Entropyï¼‰å‡½æ•°ã€‚åœ¨äºŒåˆ†ç±»ä¸­ï¼Œlabelæ˜¯{0,1}ã€‚å¯¹äºè¿›å…¥äº¤å‰ç†µå‡½æ•°çš„inputä¸ºæ¦‚ç‡åˆ†å¸ƒçš„å½¢å¼ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œinputä¸ºsigmoidæ¿€æ´»å±‚çš„è¾“å‡ºï¼Œæˆ–è€…softmaxçš„è¾“å‡ºã€‚</p>
<p><strong>ä¸»è¦å‚æ•°</strong>ï¼š</p>
<ul>
<li><code>weight</code>:æ¯ä¸ªç±»åˆ«çš„lossè®¾ç½®æƒå€¼</li>
<li><code>size_average</code>:æ•°æ®ä¸ºboolï¼Œä¸ºTrueæ—¶ï¼Œè¿”å›çš„lossä¸ºå¹³å‡å€¼ï¼›ä¸ºFalseæ—¶ï¼Œè¿”å›çš„å„æ ·æœ¬çš„lossä¹‹å’Œ.</li>
<li><code>reduce</code>:æ•°æ®ç±»å‹ä¸ºboolï¼Œä¸ºTrueæ—¶ï¼Œlossçš„è¿”å›æ˜¯æ ‡é‡ã€‚</li>
</ul>
<h3 id="_13">å…¶ä»–æŸå¤±å‡½æ•°<a class="headerlink" href="#_13" title="Permanent link">&para;</a></h3>
<p>äº¤å‰ç†µæŸå¤±å‡½æ•°</p>
<p>L1æŸå¤±å‡½æ•°</p>
<p>MSEæŸå¤±å‡½æ•°</p>
<p>å¹³æ»‘L1 (Smooth L1)æŸå¤±å‡½æ•°</p>
<p>ç›®æ ‡æ³Šæ¾åˆ†å¸ƒçš„è´Ÿå¯¹æ•°ä¼¼ç„¶æŸå¤±</p>
<p>KLæ•£åº¦</p>
<h2 id="_14">ä¼˜åŒ–å™¨<a class="headerlink" href="#_14" title="Permanent link">&para;</a></h2>
<h3 id="_15">ä»€ä¹ˆæ˜¯ä¼˜åŒ–å™¨<a class="headerlink" href="#_15" title="Permanent link">&para;</a></h3>
<p>æ·±åº¦å­¦ä¹ çš„ç›®æ ‡æ˜¯é€šè¿‡ä¸æ–­æ”¹å˜ç½‘ç»œå‚æ•°ï¼Œä½¿å¾—å‚æ•°èƒ½å¤Ÿå¯¹è¾“å…¥åšå„ç§éçº¿æ€§å˜æ¢æ‹Ÿåˆè¾“å‡ºï¼Œæœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ªå‡½æ•°å»å¯»æ‰¾æœ€ä¼˜è§£ï¼Œåªä¸è¿‡è¿™ä¸ªæœ€ä¼˜è§£ä½¿ä¸€ä¸ªçŸ©é˜µã€‚é‚£ä¹ˆæˆ‘ä»¬å¦‚ä½•è®¡ç®—å‡ºæ¥è¿™ä¹ˆå¤šçš„ç³»æ•°ï¼Œæœ‰ä»¥ä¸‹ä¸¤ç§æ–¹æ³•ï¼š</p>
<ol>
<li>ç¬¬ä¸€ç§æ˜¯æœ€ç›´æ¥çš„æš´åŠ›ç©·ä¸¾ä¸€éå‚æ•°ï¼Œè¿™ç§æ–¹æ³•çš„å®æ–½å¯èƒ½æ€§åŸºæœ¬ä¸º0ï¼Œå ªæ¯”æ„šå…¬ç§»å±±plusçš„éš¾åº¦ã€‚</li>
<li>ä¸ºäº†ä½¿æ±‚è§£å‚æ•°è¿‡ç¨‹æ›´åŠ å¿«ï¼Œäººä»¬æå‡ºäº†ç¬¬äºŒç§åŠæ³•ï¼Œå³å°±æ˜¯æ˜¯BP+ä¼˜åŒ–å™¨é€¼è¿‘æ±‚è§£ã€‚</li>
</ol>
<p>å› æ­¤ï¼Œä¼˜åŒ–å™¨å°±æ˜¯æ ¹æ®ç½‘ç»œåå‘ä¼ æ’­çš„æ¢¯åº¦ä¿¡æ¯æ¥æ›´æ–°ç½‘ç»œçš„å‚æ•°ï¼Œä»¥èµ·åˆ°é™ä½losså‡½æ•°è®¡ç®—å€¼ï¼Œä½¿å¾—æ¨¡å‹è¾“å‡ºæ›´åŠ æ¥è¿‘çœŸå®æ ‡ç­¾ã€‚</p>
<h3 id="pytorch_1">PyTorchæä¾›çš„ä¼˜åŒ–å™¨<a class="headerlink" href="#pytorch_1" title="Permanent link">&para;</a></h3>
<p>Pytorchå¾ˆäººæ€§åŒ–çš„ç»™æˆ‘ä»¬æä¾›äº†ä¸€ä¸ªä¼˜åŒ–å™¨çš„åº“torch.optimï¼Œåœ¨è¿™é‡Œé¢ç»™æˆ‘ä»¬æä¾›äº†åç§ä¼˜åŒ–å™¨ã€‚</p>
<ul>
<li>torch.optim.ASGD</li>
<li>torch.optim.Adadelta</li>
<li>torch.optim.Adagrad</li>
<li>torch.optim.Adam</li>
<li>torch.optim.AdamW</li>
<li>torch.optim.Adamax</li>
<li>torch.optim.LBFGS</li>
<li>torch.optim.RMSprop</li>
<li>torch.optim.Rprop</li>
<li>torch.optim.SGD</li>
<li>torch.optim.SparseAdam</li>
</ul>
<h2 id="_16">è®­ç»ƒä¸è¯„ä¼°<a class="headerlink" href="#_16" title="Permanent link">&para;</a></h2>
<p>å®Œæˆäº†ä¸Šè¿°è®¾å®šåå°±å¯ä»¥åŠ è½½æ•°æ®å¼€å§‹è®­ç»ƒæ¨¡å‹äº†ã€‚é¦–å…ˆåº”è¯¥è®¾ç½®æ¨¡å‹çš„çŠ¶æ€ï¼šå¦‚æœæ˜¯è®­ç»ƒçŠ¶æ€ï¼Œé‚£ä¹ˆæ¨¡å‹çš„å‚æ•°åº”è¯¥æ”¯æŒåå‘ä¼ æ’­çš„ä¿®æ”¹ï¼›å¦‚æœæ˜¯éªŒè¯/æµ‹è¯•çŠ¶æ€ï¼Œåˆ™ä¸åº”è¯¥ä¿®æ”¹æ¨¡å‹å‚æ•°ã€‚</p>
<div class="highlight"><pre><span></span><code><span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>   <span class="c1"># è®­ç»ƒçŠ¶æ€</span>
<span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>   <span class="c1"># éªŒè¯/æµ‹è¯•çŠ¶æ€</span>
</code></pre></div>
<p>è®­ç»ƒè¿‡ç¨‹ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">train</span><span class="p">(</span><span class="n">epoch</span><span class="p">):</span>
    <span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
    <span class="n">train_loss</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">data</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">train_loader</span><span class="p">:</span>  <span class="c1"># æ­¤æ—¶è¦ç”¨forå¾ªç¯è¯»å–DataLoaderä¸­çš„å…¨éƒ¨æ•°æ®ã€‚</span>
        <span class="n">data</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">cuda</span><span class="p">(),</span> <span class="n">label</span><span class="o">.</span><span class="n">cuda</span><span class="p">()</span>  <span class="c1"># ä¹‹åå°†æ•°æ®æ”¾åˆ°GPUä¸Šç”¨äºåç»­è®¡ç®—ï¼Œæ­¤å¤„ä»¥.cuda()ä¸ºä¾‹</span>
        <span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>  <span class="c1"># å¼€å§‹ç”¨å½“å‰æ‰¹æ¬¡æ•°æ®åšè®­ç»ƒæ—¶ï¼Œåº”å½“å…ˆå°†ä¼˜åŒ–å™¨çš„æ¢¯åº¦ç½®é›¶</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>  <span class="c1"># ä¹‹åå°†dataé€å…¥æ¨¡å‹ä¸­è®­ç»ƒ</span>
        <span class="n">loss</span> <span class="o">=</span> <span class="n">criterion</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span>   <span class="c1"># æ ¹æ®é¢„å…ˆå®šä¹‰çš„criterionè®¡ç®—æŸå¤±å‡½æ•°</span>
        <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>  <span class="c1"># å°†lossåå‘ä¼ æ’­å›ç½‘ç»œ</span>
        <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>  <span class="c1"># ä½¿ç”¨ä¼˜åŒ–å™¨æ›´æ–°æ¨¡å‹å‚æ•°</span>
        <span class="n">train_loss</span> <span class="o">+=</span> <span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">()</span><span class="o">*</span><span class="n">data</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">train_loss</span> <span class="o">=</span> <span class="n">train_loss</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">train_loader</span><span class="o">.</span><span class="n">dataset</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Epoch: </span><span class="si">{}</span><span class="s1"> </span><span class="se">\t</span><span class="s1">Training Loss: </span><span class="si">{:.6f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">epoch</span><span class="p">,</span> <span class="n">train_loss</span><span class="p">))</span>
</code></pre></div>
<p>éªŒè¯/æµ‹è¯•çš„æµç¨‹åŸºæœ¬ä¸è®­ç»ƒè¿‡ç¨‹ä¸€è‡´ï¼Œä¸åŒç‚¹åœ¨äºï¼š</p>
<ul>
<li>éœ€è¦é¢„å…ˆè®¾ç½®torch.no_gradï¼Œä»¥åŠå°†modelè°ƒè‡³evalæ¨¡å¼</li>
<li>ä¸éœ€è¦å°†ä¼˜åŒ–å™¨çš„æ¢¯åº¦ç½®é›¶</li>
<li>ä¸éœ€è¦å°†lossåå‘å›ä¼ åˆ°ç½‘ç»œ</li>
<li>ä¸éœ€è¦æ›´æ–°optimizer</li>
</ul>
<p>éªŒè¯/æµ‹è¯•è¿‡ç¨‹ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">val</span><span class="p">(</span><span class="n">epoch</span><span class="p">):</span>       
    <span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
    <span class="n">val_loss</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
        <span class="k">for</span> <span class="n">data</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">val_loader</span><span class="p">:</span>
            <span class="n">data</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">cuda</span><span class="p">(),</span> <span class="n">label</span><span class="o">.</span><span class="n">cuda</span><span class="p">()</span>
            <span class="n">output</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="n">preds</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">loss</span> <span class="o">=</span> <span class="n">criterion</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span>
            <span class="n">val_loss</span> <span class="o">+=</span> <span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">()</span><span class="o">*</span><span class="n">data</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">running_accu</span> <span class="o">+=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">preds</span> <span class="o">==</span> <span class="n">label</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
    <span class="n">val_loss</span> <span class="o">=</span> <span class="n">val_loss</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">val_loader</span><span class="o">.</span><span class="n">dataset</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Epoch: </span><span class="si">{}</span><span class="s1"> </span><span class="se">\t</span><span class="s1">Training Loss: </span><span class="si">{:.6f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">epoch</span><span class="p">,</span> <span class="n">val_loss</span><span class="p">))</span>
</code></pre></div>
<h2 id="_17">å¯è§†åŒ–<a class="headerlink" href="#_17" title="Permanent link">&para;</a></h2>
<p>åœ¨PyTorchæ·±åº¦å­¦ä¹ ä¸­ï¼Œå¯è§†åŒ–æ˜¯ä¸€ä¸ªå¯é€‰é¡¹ï¼ŒæŒ‡çš„æ˜¯æŸäº›ä»»åŠ¡åœ¨è®­ç»ƒå®Œæˆåï¼Œéœ€è¦å¯¹ä¸€äº›å¿…è¦çš„å†…å®¹è¿›è¡Œå¯è§†åŒ–ï¼Œæ¯”å¦‚åˆ†ç±»çš„ROCæ›²çº¿ï¼Œå·ç§¯ç½‘ç»œä¸­çš„å·ç§¯æ ¸ï¼Œä»¥åŠè®­ç»ƒ/éªŒè¯è¿‡ç¨‹çš„æŸå¤±å‡½æ•°æ›²çº¿ç­‰ç­‰ã€‚</p>
<h2 id="_18">å‚è€ƒèµ„æ–™<a class="headerlink" href="#_18" title="Permanent link">&para;</a></h2>
<ul>
<li>Datawhaleå¼€æºé¡¹ç›®ï¼šæ·±å…¥æµ…å‡ºPyTorch <a href="https://github.com/datawhalechina/thorough-pytorch/">https://github.com/datawhalechina/thorough-pytorch/</a></li>
<li>æå®æ¯…æœºå™¨å­¦ä¹ 2021æ˜¥-PyTorch Tutorial <a href="https://www.bilibili.com/video/BV1Wv411h7kN?p=5">https://www.bilibili.com/video/BV1Wv411h7kN?p=5</a></li>
<li>åŠ¨æ‰‹å­¦æ·±åº¦å­¦ä¹ pytorchç‰ˆ <a href="https://zh-v2.d2l.ai/chapter_preface/index.html">https://zh-v2.d2l.ai/chapter_preface/index.html</a></li>
<li>PyTorchå®˜æ–¹æ•™ç¨‹ä¸­æ–‡ç‰ˆ <a href="https://pytorch123.com/SecondSection/training_a_classifier/">https://pytorch123.com/SecondSection/training_a_classifier/</a></li>
</ul>

  <hr>
<div class="md-source-file">
  <small>
    
      Last update:
      <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">July 11, 2022</span>
      
    
  </small>
</div>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../pytorch-chap01-02/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Chapter01-02 PyTorchçš„ç®€ä»‹å’Œå®‰è£…ã€PyTorchåŸºç¡€çŸ¥è¯†" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Chapter01-02 PyTorchçš„ç®€ä»‹å’Œå®‰è£…ã€PyTorchåŸºç¡€çŸ¥è¯†
            </div>
          </div>
        </a>
      
      
        
        <a href="../pytorch-chap04/" class="md-footer__link md-footer__link--next" aria-label="Next: Chapter04 PyTorchåŸºç¡€å®æˆ˜â€”â€”FashionMNISTå›¾åƒåˆ†ç±»" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Chapter04 PyTorchåŸºç¡€å®æˆ˜â€”â€”FashionMNISTå›¾åƒåˆ†ç±»
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      &copy; 2022 by Xiaoyu Chu
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs", "navigation.tabs.sticky"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../assets/javascripts/workers/search.0bbba5b5.min.js"}</script>
    
    
      <script src="../assets/javascripts/bundle.649a939e.min.js"></script>
      
        <script src="../js/extra.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
    
  </body>
</html>